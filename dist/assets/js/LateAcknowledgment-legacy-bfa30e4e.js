System.register(["./index-legacy-9eeb83db.js","./react-vendor-legacy-4587369d.js"],function(e,t){"use strict";var a,s,r,n,i,l;return{setters:[e=>{a=e.j,s=e.u,r=e.b,n=e.a},e=>{i=e.N,l=e.r}],execute:function(){e("default",function(){const e=localStorage.getItem("auth"),t=e?JSON.parse(e):null;if(!t||"staff"!==t.role)return a(i,{to:"/home",replace:!0});const{showSuccess:c,showError:d}=s(),[o,u]=l.useState([]),[m,h]=l.useState(!1),g=async()=>{try{h(!0);const e=new URLSearchParams({department:t.department,type:"late",status:"requested"}),a=await n.get(`/api/leaves?${e.toString()}`);if(a.success){const e=(a.requests||[]).filter(e=>e.studentDetails?.year===t.year&&e.studentDetails?.section===t.section);u(e)}}catch(e){}finally{h(!1)}};return l.useEffect(()=>{g()},[]),r("div",{className:"px-4 py-4 w-full max-w-4xl mx-auto",children:[a("h1",{className:"text-2xl font-bold mb-4",children:"Late Acknowledgment"}),m?a("div",{className:"p-4 text-gray-500",children:"Loading..."}):r("ul",{className:"divide-y bg-white rounded-xl shadow",children:[o.map(e=>{return r("li",{className:"p-4 flex items-center justify-between",children:[r("div",{children:[r("div",{className:"font-medium",children:[e.studentDetails?.name," (",e.studentDetails?.regNumber,")"]}),r("div",{className:"text-sm text-gray-600",children:["Expected: ",(s=e.expectedArrivalTime,s?new Date(s).toLocaleString("en-IN",{dateStyle:"medium",timeStyle:"short"}):"-")]}),r("div",{className:"text-sm text-gray-600",children:["Reason: ",e.reason]})]}),a("div",{className:"flex gap-2",children:a("button",{onClick:()=>(async e=>{try{const a=await n.patch(`/api/leaves?id=${e}&action=acknowledge`,{staffId:t.id});a&&a.success?(c("Acknowledged","Late arrival recorded and parent notified"),g()):d("Failed",a?.error||"Could not acknowledge request")}catch(a){d("Error",a.message)}})(e._id),className:"px-3 py-2 text-sm rounded-lg bg-blue-600 text-white",children:"Record Arrival"})})]},e._id);var s}),0===o.length&&a("li",{className:"p-4 text-gray-500",children:"No pending late notifications."})]})]})})}}});
