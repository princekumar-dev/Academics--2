System.register(["./index-legacy-9eeb83db.js","./react-vendor-legacy-4587369d.js"],function(e,t){"use strict";var a,l,r,s;return{setters:[e=>{a=e.j,l=e.b,r=e.a},e=>{s=e.r}],execute:function(){e("default",function(){const[e,t]=s.useState(()=>{const e=localStorage.getItem("auth");return e?JSON.parse(e):null}),[n,i]=s.useState(null),[c,d]=s.useState(!1),[o,m]=s.useState(""),[x,u]=s.useState(null),[h,p]=s.useState([]);return e&&"staff"===e.role?a("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:a("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l("div",{className:"max-w-4xl mx-auto",children:[l("div",{className:"text-center mb-8",children:[a("h1",{className:"text-4xl sm:text-5xl lg:text-6xl font-black text-gray-900 mb-4",children:"Import Student Marks"}),l("p",{className:"text-lg text-gray-600 max-w-3xl mx-auto",children:["Upload Excel file with student marks data for ",e.department," Department - Year ",e.year]})]}),l("div",{className:"glass-card p-8 rounded-3xl mb-8",children:[l("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-12 text-center",children:[a("svg",{className:"w-16 h-16 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),a("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Drop Excel file here"}),a("p",{className:"text-gray-600 mb-6",children:"or click to browse"}),a("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:e=>{e.target.files&&e.target.files[0]&&i(e.target.files[0])},className:"hidden",id:"excelFile"}),a("label",{htmlFor:"excelFile",className:"glass-button px-6 py-3 text-blue-600 rounded-xl font-bold cursor-pointer inline-block",children:n?"Change File":"Choose File"}),n&&l("div",{className:"mt-4 text-gray-700",children:["Selected: ",a("span",{className:"font-semibold",children:n.name})]}),a("div",{className:"mt-6",children:a("button",{disabled:!n||c,onClick:async()=>{if(n){d(!0),p([]),u(null);try{const a=new FormData;a.append("excelFile",n),a.append("staffId",e.id),a.append("examinationDate",(new Date).toISOString()),a.append("department",e.department),a.append("year",e.year);try{const e=await r.post("/api/import-excel?action=upload",a);e&&e.success?(m(e.sessionId),p(e.errorMessages||[])):p([e?.error||"Upload failed"])}catch(t){p([t.message||"Unexpected error"])}}catch(a){p([a.message||"Unexpected error"])}finally{d(!1)}}},className:"px-6 py-3 rounded-xl font-bold "+(!n||c?"bg-gray-300 text-gray-500":"glass-button text-blue-600"),children:c?"Uploading...":"Upload"})})]}),o&&l("div",{className:"mt-6 p-4 bg-green-50 rounded-xl text-green-800",children:["Temporary session created. Session ID: ",a("span",{className:"font-mono",children:o}),a("div",{className:"mt-3",children:a("button",{onClick:async()=>{if(o){d(!0);try{try{const e=await r.post("/api/import-excel?action=confirm",{sessionId:o});e&&e.success?u(e):p([e?.error||"Confirm failed"])}catch(e){p([e.message||"Unexpected error"])}}catch(t){p([t.message||"Unexpected error"])}finally{d(!1)}}},disabled:c,className:"px-5 py-2 rounded-lg font-semibold "+(c?"bg-gray-300 text-gray-500":"bg-green-600 text-white"),children:c?"Processing...":"Confirm Import"})})]}),h&&h.length>0&&l("div",{className:"mt-6 p-4 bg-red-50 rounded-xl text-red-800",children:[a("div",{className:"font-semibold mb-2",children:"Issues found:"}),a("ul",{className:"list-disc pl-6 space-y-1",children:h.map((e,t)=>a("li",{children:e},t))})]}),x&&l("div",{className:"mt-6 p-4 bg-blue-50 rounded-xl text-blue-900",children:[a("div",{className:"font-semibold mb-2",children:"Import Completed"}),l("div",{children:["Created: ",x.createdCount]})]}),l("div",{className:"mt-8 p-6 bg-blue-50 rounded-xl",children:[a("h4",{className:"text-lg font-semibold text-blue-900 mb-3",children:"Excel Format Requirements:"}),l("ul",{className:"text-blue-800 space-y-2",children:[l("li",{children:["• ",a("strong",{children:"Name"})," - Student full name"]}),l("li",{children:["• ",a("strong",{children:"RegNumber"})," - Student registration number"]}),l("li",{children:["• ",a("strong",{children:"Section"})," - Class section (A, B, etc.)"]}),l("li",{children:["• ",a("strong",{children:"ParentPhone"})," - Parent WhatsApp number"]}),l("li",{children:["• ",a("strong",{children:"Subject Columns"})," - Each subject with marks (0-100)"]})]})]})]})]})})}):a("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 flex items-center justify-center",children:l("div",{className:"glass-card p-8 rounded-3xl text-center",children:[a("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Access Denied"}),a("p",{className:"text-gray-600",children:"Only staff members can import marks."})]})})})}}});
