import{u as N,b as s,j as t,a as w,g as v}from"./index-ba65f9b1.js";import{r as g,u as S}from"./react-vendor-ad4d5528.js";function I(){const[r,d]=g.useState({email:"",password:"",regNumber:"",loginType:"staff"}),[b,l]=g.useState(!1),[u,n]=g.useState(""),h=S(),{showSuccess:x,showError:p}=N(),c=i=>{const{name:f,value:e}=i.target;d(a=>({...a,[f]:e})),u&&n("")};return s("div",{className:"min-h-screen flex items-center justify-center px-4 py-8",children:[t("style",{children:"\n          @keyframes waveButtonAnimation {\n            0%, 100% {\n              background-position: 0% 50%;\n            }\n            50% {\n              background-position: 100% 50%;\n            }\n          }\n          \n          .login-wave-button {\n            background: linear-gradient(90deg, var(--theme-gold-600), var(--theme-gold-300), var(--theme-gold-600), var(--theme-gold-300));\n            background-size: 300% 100%;\n            animation: waveButtonAnimation 3s ease-in-out infinite;\n            transition: all 0.3s ease;\n          }\n          \n          .login-wave-button:hover {\n            animation-duration: 1.5s;\n          }\n        "}),t("div",{className:"relative z-10",children:t("div",{className:"w-full max-w-md relative z-10",children:s("div",{className:"backdrop-blur-md bg-white/20 border border-white/30 p-8 rounded-3xl shadow-2xl",children:[s("div",{className:"text-center mb-8",children:[t("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-100 rounded-full mb-6",children:t("svg",{className:"w-8 h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),t("h1",{className:"text-3xl sm:text-4xl font-black text-white mb-2",children:"Welcome Back"}),t("p",{className:"text-gray-100 text-lg",children:"Sign in to your MSEC Academics account"})]}),u&&t("div",{className:"mb-6",children:t("div",{className:"backdrop-blur-sm bg-red-500/20 border border-red-400/50 p-4 border-l-4 rounded-lg",children:t("p",{className:"text-red-100 text-sm font-medium",children:u})})}),s("form",{onSubmit:async i=>{if(i.preventDefault(),l(!0),n(""),r.loginType==="student"){if(!r.regNumber||!r.password){const e=r.regNumber?"password":"registration number";n("ðŸ“ Please enter your ".concat(e," to continue.")),l(!1);return}}else{if(!r.email||!r.password){const a=r.email?"password":"email address";n("ðŸ“ Please enter your ".concat(a," to continue.")),l(!1);return}if(r.email.toLowerCase().split("@")[1]!=="msec.edu.in"){n("ðŸ« Only MSEC institutional emails are allowed. Use your @msec.edu.in email address."),l(!1);return}}try{const e=await w.post("/api/auth",r);if(e.success){const a={isAuthenticated:!0,email:e.user.email,name:e.user.name,role:e.user.role,department:e.user.department,id:e.user.id,year:e.user.year,section:e.user.section,regNumber:e.user.regNumber,phoneNumber:e.user.phoneNumber,parentPhoneNumber:e.user.parentPhoneNumber,loginTime:new Date().toISOString()};localStorage.setItem("auth",JSON.stringify(a)),localStorage.setItem("isLoggedIn","true"),e.user.email&&localStorage.setItem("userEmail",e.user.email),localStorage.setItem("userRole",e.user.role),localStorage.setItem("userId",e.user.id);let m=e.user.name;try{const o=await w.get("/api/users?id=".concat(e.user.id));if(o!=null&&o.success&&o.user){const y={...a,...o.user};localStorage.setItem("auth",JSON.stringify(y)),m=o.user.name||m}}catch(o){}x("Welcome Back!","Logged in as ".concat(m)),setTimeout(()=>{h("/",{replace:!0}),window.dispatchEvent(new Event("authStateChanged"))},500)}else{const a=e.error||"ðŸ” Invalid credentials. Please check your email and password, then try again.";n(a),p("Login Failed",a+" Need help? Contact support@msec.edu.in")}}catch(e){const a=v(e,"Login failed. Please try again or contact support.");n(a),p("Login Failed",a)}finally{l(!1)}},className:"space-y-6",children:[s("div",{className:"grid grid-cols-2 gap-3",children:[t("button",{type:"button",onClick:()=>d(i=>({...i,loginType:"staff"})),className:"w-full py-3 rounded-2xl border text-sm font-bold transition-all ".concat(r.loginType==="staff"?"bg-white text-blue-700 border-white":"bg-white/10 text-white border-white/30"),children:"Staff / HOD"}),t("button",{type:"button",onClick:()=>d(i=>({...i,loginType:"student"})),className:"w-full py-3 rounded-2xl border text-sm font-bold transition-all ".concat(r.loginType==="student"?"bg-white text-blue-700 border-white":"bg-white/10 text-white border-white/30"),children:"Student"})]}),r.loginType==="staff"&&s("div",{children:[t("label",{className:"block text-sm font-bold text-white mb-3",children:"Email Address"}),t("input",{type:"email",name:"email",value:r.email,onChange:c,pattern:".*@msec\\.edu\\.in$",title:"Please use your MSEC email address (@msec.edu.in)",className:"w-full px-4 py-4 border-0 rounded-2xl backdrop-blur-sm bg-white/20 border border-white/30 focus:ring-2 focus:ring-blue-300 focus:outline-none transition-all duration-200 text-white placeholder:text-gray-200",placeholder:"Enter your MSEC email address",required:r.loginType==="staff"})]}),r.loginType==="student"&&s("div",{children:[t("label",{className:"block text-sm font-bold text-white mb-3",children:"Registration Number"}),t("input",{type:"text",name:"regNumber",value:r.regNumber,onChange:c,className:"w-full px-4 py-4 border-0 rounded-2xl backdrop-blur-sm bg-white/20 border border-white/30 focus:ring-2 focus:ring-blue-300 focus:outline-none transition-all duration-200 text-white placeholder:text-gray-200",placeholder:"Enter your registration number",required:r.loginType==="student"})]}),s("div",{children:[t("label",{className:"block text-sm font-bold text-white mb-3",children:"Password"}),t("input",{type:"password",name:"password",value:r.password,onChange:c,className:"w-full px-4 py-4 border-0 rounded-2xl backdrop-blur-sm bg-white/20 border border-white/30 focus:ring-2 focus:ring-blue-300 focus:outline-none transition-all duration-200 text-white placeholder:text-gray-200",placeholder:"Enter your password",required:!0})]}),t("div",{className:"pt-4",children:t("button",{type:"submit",disabled:b,className:"glass-button w-full py-4 px-6 text-blue-600 text-lg font-bold rounded-2xl transition-all duration-300 hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed",children:t("span",{className:"truncate",children:b?"Signing in...":"Sign In"})})})]}),r.loginType==="staff"&&t("div",{className:"mt-8 text-center",children:s("p",{className:"text-gray-100 text-sm",children:["Don't have an account?",t("span",{className:"text-blue-600 font-semibold cursor-pointer hover:underline ml-1",onClick:()=>h("/signup"),children:"Sign up"})]})})]})})})]})}export{I as default};
