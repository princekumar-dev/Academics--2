System.register(["./index-legacy-539dcb9c.js","./react-vendor-legacy-4587369d.js"],function(e,t){"use strict";var a,s,r,n,i,l,c;return{setters:[e=>{a=e.j,s=e.u,r=e.b,n=e.a,i=e.g},e=>{l=e.N,c=e.r}],execute:function(){e("default",function(){const e=localStorage.getItem("auth"),t=e?JSON.parse(e):null;if(!t||"staff"!==t.role)return a(l,{to:"/home",replace:!0});const{showSuccess:d,showError:o}=s(),[u,m]=c.useState([]),[h,f]=c.useState(!1),g=async()=>{try{f(!0);const e=new URLSearchParams({department:t.department,type:"late",status:"requested"}),a=await n.get(`/api/leaves?${e.toString()}`);if(a.success){const e=(a.requests||[]).filter(e=>e.studentDetails?.year===t.year&&e.studentDetails?.section===t.section);m(e)}}catch(e){}finally{f(!1)}};return c.useEffect(()=>{g()},[]),r("div",{className:"px-4 py-4 w-full max-w-4xl mx-auto",children:[a("h1",{className:"text-2xl font-bold mb-4",children:"Late Acknowledgment"}),h?a("div",{className:"p-4 text-gray-500",children:"Loading..."}):r("ul",{className:"divide-y bg-white rounded-xl shadow",children:[u.map(e=>{return r("li",{className:"p-4 flex items-center justify-between",children:[r("div",{children:[r("div",{className:"font-medium",children:[e.studentDetails?.name," (",e.studentDetails?.regNumber,")"]}),r("div",{className:"text-sm text-gray-600",children:["Expected: ",(s=e.expectedArrivalTime,s?new Date(s).toLocaleString("en-IN",{dateStyle:"medium",timeStyle:"short"}):"-")]}),r("div",{className:"text-sm text-gray-600",children:["Reason: ",e.reason]})]}),a("div",{className:"flex gap-2",children:a("button",{onClick:()=>(async e=>{try{const s=await n.patch(`/api/leaves?id=${e}&action=acknowledge`,{staffId:t.id});if(s&&s.success){d("Acknowledged","Late arrival recorded and parent notified"),g();try{window.refreshNotificationCount&&window.refreshNotificationCount()}catch(a){}}else o("Failed",s?.error||"Could not acknowledge request")}catch(s){o("Error",i(s,"Could not acknowledge request. Please try again."))}})(e._id),className:"px-3 py-2 text-sm rounded-lg bg-blue-600 text-white",children:"Record Arrival"})})]},e._id);var s}),0===u.length&&a("li",{className:"p-4 text-gray-500",children:"No pending late notifications."})]})]})})}}});
