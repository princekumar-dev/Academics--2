System.register(["./index-legacy-9eeb83db.js","./react-vendor-legacy-4587369d.js"],function(e,t){"use strict";var n,r,o,a,l,s;return{setters:[e=>{n=e.u,r=e.b,o=e.j,a=e.a},e=>{l=e.r,s=e.u}],execute:function(){e("default",function(){const[e,t]=l.useState({email:"",password:"",regNumber:"",loginType:"staff"}),[i,d]=l.useState(!1),[u,c]=l.useState(""),m=s(),{showSuccess:g,showError:h}=n(),b=e=>{const{name:n,value:r}=e.target;t(e=>({...e,[n]:r})),u&&c("")};return r("div",{className:"min-h-screen flex items-center justify-center px-4 py-8 smooth-scroll mobile-smoothest-scroll no-mobile-anim",children:[o("style",{children:"\n          @keyframes waveButtonAnimation {\n            0%, 100% {\n              background-position: 0% 50%;\n            }\n            50% {\n              background-position: 100% 50%;\n            }\n          }\n          \n          .login-wave-button {\n            background: linear-gradient(90deg, var(--theme-gold-600), var(--theme-gold-300), var(--theme-gold-600), var(--theme-gold-300));\n            background-size: 300% 100%;\n            animation: waveButtonAnimation 3s ease-in-out infinite;\n            transition: all 0.3s ease;\n          }\n          \n          .login-wave-button:hover {\n            animation-duration: 1.5s;\n          }\n        "}),o("div",{className:"relative z-10",children:o("div",{className:"w-full max-w-md relative z-10",children:r("div",{className:"backdrop-blur-md bg-white/20 border border-white/30 p-8 rounded-3xl shadow-2xl",children:[r("div",{className:"text-center mb-8",children:[o("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-100 rounded-full mb-6",children:o("svg",{className:"w-8 h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),o("h1",{className:"text-3xl sm:text-4xl font-black text-white mb-2",children:"Welcome Back"}),o("p",{className:"text-gray-100 text-lg",children:"Sign in to your MSEC Academics account"})]}),u&&o("div",{className:"mb-6",children:o("div",{className:"backdrop-blur-sm bg-red-500/20 border border-red-400/50 p-4 border-l-4 rounded-lg",children:o("p",{className:"text-red-100 text-sm font-medium",children:u})})}),r("form",{onSubmit:async t=>{if(t.preventDefault(),d(!0),c(""),"student"===e.loginType){if(!e.regNumber||!e.password){const t=e.regNumber?"password":"registration number";return c(`ðŸ“ Please enter your ${t} to continue.`),void d(!1)}}else{if(!e.email||!e.password){const t=e.email?"password":"email address";return c(`ðŸ“ Please enter your ${t} to continue.`),void d(!1)}if("msec.edu.in"!==e.email.toLowerCase().split("@")[1])return c("ðŸ« Only MSEC institutional emails are allowed. Use your @msec.edu.in email address."),void d(!1)}try{console.log("ðŸ” Login attempt:",{email:e.email,loginType:e.loginType});const t=await a.post("/api/auth",e);if(console.log("ðŸ“¡ Auth API Response Data:",t),console.log("ðŸ“¡ Auth API Response Data:",t),t.success){console.log("âœ… Authentication successful");const e={isAuthenticated:!0,email:t.user.email,name:t.user.name,role:t.user.role,department:t.user.department,id:t.user.id,year:t.user.year,section:t.user.section,regNumber:t.user.regNumber,phoneNumber:t.user.phoneNumber,parentPhoneNumber:t.user.parentPhoneNumber,loginTime:(new Date).toISOString()};localStorage.setItem("auth",JSON.stringify(e)),console.log("ðŸ’¾ Auth saved to localStorage:",e),localStorage.setItem("isLoggedIn","true"),t.user.email&&localStorage.setItem("userEmail",t.user.email),localStorage.setItem("userRole",t.user.role),localStorage.setItem("userId",t.user.id),g("Welcome Back!",`Logged in as ${t.user.name}`),console.log("ðŸ”„ Redirecting to home after 500ms..."),setTimeout(()=>{console.log("âœˆï¸ Navigating to / with auth:",JSON.stringify(JSON.parse(localStorage.getItem("auth")),null,2)),m("/",{replace:!0}),window.dispatchEvent(new Event("authStateChanged"))},500)}else{const e=t.error||"ðŸ” Invalid credentials. Please check your email and password, then try again.";c(e),h("Login Failed",e+" Need help? Contact support@msec.edu.in")}}catch(n){let e;console.error("Login error:",n),e=n.message?.includes("fetch")||n.message?.includes("network")?"ðŸŒ Connection failed. Check your internet connection and try again.":n.message?.includes("timeout")?"â±ï¸ Request timed out. The server is slow to respond. Please try again.":"âŒ Login failed: "+(n.message||"Unknown error. Please try again or contact support."),c(e),h("Error",e)}finally{d(!1)}},className:"space-y-6",children:[r("div",{className:"grid grid-cols-2 gap-3",children:[o("button",{type:"button",onClick:()=>t(e=>({...e,loginType:"staff"})),className:"w-full py-3 rounded-2xl border text-sm font-bold transition-all "+("staff"===e.loginType?"bg-white text-blue-700 border-white":"bg-white/10 text-white border-white/30"),children:"Staff / HOD"}),o("button",{type:"button",onClick:()=>t(e=>({...e,loginType:"student"})),className:"w-full py-3 rounded-2xl border text-sm font-bold transition-all "+("student"===e.loginType?"bg-white text-blue-700 border-white":"bg-white/10 text-white border-white/30"),children:"Student"})]}),"staff"===e.loginType&&r("div",{children:[o("label",{className:"block text-sm font-bold text-white mb-3",children:"Email Address"}),o("input",{type:"email",name:"email",value:e.email,onChange:b,pattern:".*@msec\\.edu\\.in$",title:"Please use your MSEC email address (@msec.edu.in)",className:"w-full px-4 py-4 border-0 rounded-2xl backdrop-blur-sm bg-white/20 border border-white/30 focus:ring-2 focus:ring-blue-300 focus:outline-none transition-all duration-200 text-white placeholder:text-gray-200",placeholder:"Enter your MSEC email address",required:"staff"===e.loginType})]}),"student"===e.loginType&&r("div",{children:[o("label",{className:"block text-sm font-bold text-white mb-3",children:"Registration Number"}),o("input",{type:"text",name:"regNumber",value:e.regNumber,onChange:b,className:"w-full px-4 py-4 border-0 rounded-2xl backdrop-blur-sm bg-white/20 border border-white/30 focus:ring-2 focus:ring-blue-300 focus:outline-none transition-all duration-200 text-white placeholder:text-gray-200",placeholder:"Enter your registration number",required:"student"===e.loginType})]}),r("div",{children:[o("label",{className:"block text-sm font-bold text-white mb-3",children:"Password"}),o("input",{type:"password",name:"password",value:e.password,onChange:b,className:"w-full px-4 py-4 border-0 rounded-2xl backdrop-blur-sm bg-white/20 border border-white/30 focus:ring-2 focus:ring-blue-300 focus:outline-none transition-all duration-200 text-white placeholder:text-gray-200",placeholder:"Enter your password",required:!0})]}),o("div",{className:"pt-4",children:o("button",{type:"submit",disabled:i,className:"glass-button w-full py-4 px-6 text-blue-600 text-lg font-bold rounded-2xl transition-all duration-300 hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed",children:o("span",{className:"truncate",children:i?"Signing in...":"Sign In"})})})]}),"staff"===e.loginType&&o("div",{className:"mt-8 text-center",children:r("p",{className:"text-gray-100 text-sm",children:["Don't have an account?",o("span",{className:"text-blue-600 font-semibold cursor-pointer hover:underline ml-1",onClick:()=>m("/signup"),children:"Sign up"})]})})]})})})]})})}}});
