System.register(["./index-legacy-9eeb83db.js","./react-vendor-legacy-4587369d.js","./usePullToRefresh-legacy-3141b38e.js"],function(e,t){"use strict";var s,a,r,l,n,d,o;return{setters:[e=>{s=e.j,a=e.u,r=e.b,l=e.a},e=>{n=e.N,d=e.r},e=>{o=e.u}],execute:function(){e("default",function(){const e=localStorage.getItem("auth"),t=e?JSON.parse(e):null;if(!t||"hod"!==t.role)return s(n,{to:"/home",replace:!0});const{showSuccess:c,showError:i}=a(),[u,p]=d.useState([]),[h,m]=d.useState(!1),[g,v]=d.useState(null),x=async()=>{try{m(!0);const e=new URLSearchParams({department:t.department,type:"leave",status:"requested"});console.log("[LeaveApprovals] Fetching with:",{department:t.department,type:"leave",status:"requested"});const s=await l.get(`/api/leaves?${e.toString()}`);console.log("[LeaveApprovals] Response:",s),s.success?(p(s.requests||[]),v({filter:s.filter,count:s.requests?.length||0,hodDept:t.department})):i("Failed to load",s.error||"Could not fetch requests")}catch(e){console.error("[LeaveApprovals] Error:",e),i("Error",e.message)}finally{m(!1)}};d.useEffect(()=>{x()},[]),o(x);const y=async(e,s)=>{try{const a=await l.patch(`/api/leaves?id=${e}&action=${s}`,{hodId:t.id});a&&a.success?(c("approve"===s?"Approved":"Rejected","Request updated"),x()):i("Failed",a?.error||"Could not update request")}catch(a){i("Error",a.message)}};return r("div",{className:"px-4 py-4 w-full max-w-4xl mx-auto",children:[r("div",{className:"flex items-center justify-between mb-4",children:[s("h1",{className:"text-2xl font-bold",children:"Leave Approvals"}),s("button",{onClick:x,className:"px-3 py-2 text-sm rounded-lg border bg-white hover:bg-gray-50",disabled:h,children:h?"Loading...":"Refresh"})]}),g&&r("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg text-xs",children:[r("div",{children:["HOD Dept: ",g.hodDept]}),r("div",{children:["Found: ",g.count," requests"]})]}),h?s("div",{className:"p-4 text-gray-500",children:"Loading..."}):r("ul",{className:"divide-y bg-white rounded-xl shadow",children:[u.map(e=>r("li",{className:"p-4 flex items-center justify-between",children:[r("div",{children:[r("div",{className:"font-medium",children:[e.studentDetails?.name," (",e.studentDetails?.regNumber,")"]}),r("div",{className:"text-sm text-gray-600",children:[new Date(e.startDate).toLocaleDateString()," â†’ ",new Date(e.endDate).toLocaleDateString()]}),r("div",{className:"text-sm text-gray-600",children:["Reason: ",e.reason]})]}),r("div",{className:"flex gap-2",children:[s("button",{onClick:()=>y(e._id,"approve"),className:"px-3 py-2 text-sm rounded-lg bg-green-600 text-white",children:"Approve"}),s("button",{onClick:()=>y(e._id,"reject"),className:"px-3 py-2 text-sm rounded-lg bg-red-600 text-white",children:"Reject"})]})]},e._id)),0===u.length&&s("li",{className:"p-4 text-gray-500",children:"No pending requests."})]})]})})}}});
