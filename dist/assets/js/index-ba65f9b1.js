import{r as i,a as Pt,R as pt,u as bt,b as Ue,c as Xe,L as K,B as Dt,d as Tt,e as te,N as ue}from"./react-vendor-ad4d5528.js";function ma(){import.meta.url,import("_").catch(()=>1);async function*t(){}}(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const p of l.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&o(p)}).observe(document,{childList:!0,subtree:!0});function s(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(n){if(n.ep)return;n.ep=!0;const l=s(n);fetch(n.href,l)}})();const Mt="modulepreload",jt=function(t){return"/"+t},rt={},Y=function(r,s,o){if(!s||s.length===0)return r();const n=document.getElementsByTagName("link");return Promise.all(s.map(l=>{if(l=jt(l),l in rt)return;rt[l]=!0;const p=l.endsWith(".css"),g=p?'[rel="stylesheet"]':"";if(!!o)for(let N=n.length-1;N>=0;N--){const m=n[N];if(m.href===l&&(!p||m.rel==="stylesheet"))return}else if(document.querySelector('link[href="'.concat(l,'"]').concat(g)))return;const h=document.createElement("link");if(h.rel=p?"stylesheet":Mt,p||(h.as="script",h.crossOrigin=""),h.href=l,document.head.appendChild(h),p)return new Promise((N,m)=>{h.addEventListener("load",N),h.addEventListener("error",()=>m(new Error("Unable to preload CSS for ".concat(l))))})})).then(()=>r()).catch(l=>{const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=l,window.dispatchEvent(p),!p.defaultPrevented)throw l})};var vt={exports:{}},He={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ot=i,zt=Symbol.for("react.element"),Wt=Symbol.for("react.fragment"),$t=Object.prototype.hasOwnProperty,Ut=Ot.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Bt={key:!0,ref:!0,__self:!0,__source:!0};function wt(t,r,s){var o,n={},l=null,p=null;s!==void 0&&(l=""+s),r.key!==void 0&&(l=""+r.key),r.ref!==void 0&&(p=r.ref);for(o in r)$t.call(r,o)&&!Bt.hasOwnProperty(o)&&(n[o]=r[o]);if(t&&t.defaultProps)for(o in r=t.defaultProps,r)n[o]===void 0&&(n[o]=r[o]);return{$$typeof:zt,type:t,key:l,ref:p,props:n,_owner:Ut.current}}He.Fragment=Wt;He.jsx=wt;He.jsxs=wt;vt.exports=He;var Ke=vt.exports;const fe=Ke.Fragment,e=Ke.jsx,a=Ke.jsxs;var Ye={},at=Pt;Ye.createRoot=at.createRoot,Ye.hydrateRoot=at.hydrateRoot;function ga({rows:t=5,columns:r=6}){return e("div",{className:"space-y-3",children:[...Array(t)].map((s,o)=>e("div",{className:"flex gap-4 animate-pulse",children:[...Array(r)].map((n,l)=>e("div",{className:"h-12 bg-gray-200 rounded-lg",style:{width:l===0?"5%":l===1?"25%":l===2?"20%":l===3?"15%":l===4?"20%":"15%"}},l))},o))})}function ze(){return a("div",{className:"p-4 md:p-6 space-y-6 animate-pulse",children:[a("div",{children:[e("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-2"}),e("div",{className:"h-4 bg-gray-100 rounded w-1/2"})]}),e("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[1,2,3,4].map(t=>a("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[e("div",{className:"h-4 bg-gray-200 rounded w-2/3 mb-3"}),e("div",{className:"h-8 bg-gray-300 rounded w-1/3 mb-2"}),e("div",{className:"h-3 bg-gray-100 rounded w-1/2"})]},t))}),a("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[e("div",{className:"h-6 bg-gray-200 rounded w-1/4 mb-4"}),e("div",{className:"space-y-3",children:[1,2,3].map(t=>a("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[e("div",{className:"w-10 h-10 bg-gray-200 rounded-full"}),a("div",{className:"flex-1",children:[e("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e("div",{className:"h-3 bg-gray-100 rounded w-1/2"})]})]},t))})]})]})}function st(){return a("div",{className:"p-4 md:p-6 space-y-4 animate-pulse",children:[a("div",{className:"flex flex-col sm:flex-row justify-between gap-4 mb-6",children:[a("div",{children:[e("div",{className:"h-8 bg-gray-200 rounded w-48 mb-2"}),e("div",{className:"h-4 bg-gray-100 rounded w-64"})]}),a("div",{className:"flex gap-2",children:[e("div",{className:"h-10 bg-gray-200 rounded w-32"}),e("div",{className:"h-10 bg-gray-200 rounded w-24"})]})]}),a("div",{className:"flex gap-2 mb-4",children:[e("div",{className:"flex-1 h-12 bg-gray-200 rounded-xl"}),e("div",{className:"h-12 bg-gray-200 rounded-xl w-32"})]}),e("div",{className:"space-y-4",children:[1,2,3,4,5].map(t=>a("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[a("div",{className:"flex justify-between items-start mb-4",children:[a("div",{className:"flex-1",children:[e("div",{className:"h-6 bg-gray-300 rounded w-2/3 mb-2"}),e("div",{className:"h-4 bg-gray-100 rounded w-1/3"})]}),e("div",{className:"h-8 bg-gray-200 rounded-full w-24"})]}),e("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[1,2,3,4].map(r=>a("div",{children:[e("div",{className:"h-3 bg-gray-100 rounded w-16 mb-2"}),e("div",{className:"h-4 bg-gray-200 rounded w-20"})]},r))})]},t))})]})}function Ht(){return a("div",{className:"p-4 md:p-6 animate-pulse",children:[e("div",{className:"h-10 bg-gray-200 rounded w-32 mb-6"}),a("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[a("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-6 border-b border-gray-100",children:[a("div",{className:"flex justify-between items-start mb-4",children:[a("div",{className:"flex-1",children:[e("div",{className:"h-8 bg-gray-300 rounded w-2/3 mb-3"}),e("div",{className:"h-4 bg-gray-200 rounded w-1/3"})]}),e("div",{className:"h-10 bg-gray-300 rounded-full w-32"})]}),e("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[1,2,3,4].map(t=>a("div",{children:[e("div",{className:"h-3 bg-gray-200 rounded w-16 mb-2"}),e("div",{className:"h-5 bg-gray-300 rounded w-24"})]},t))})]}),a("div",{className:"p-6 space-y-6",children:[a("div",{children:[e("div",{className:"h-6 bg-gray-200 rounded w-32 mb-4"}),e("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[1,2,3,4,5,6].map(t=>a("div",{children:[e("div",{className:"h-3 bg-gray-100 rounded w-20 mb-2"}),e("div",{className:"h-5 bg-gray-200 rounded w-32"})]},t))})]}),a("div",{children:[e("div",{className:"h-6 bg-gray-200 rounded w-24 mb-4"}),a("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[e("div",{className:"bg-gray-50 p-4 border-b",children:a("div",{className:"flex gap-4",children:[e("div",{className:"h-4 bg-gray-300 rounded w-32"}),e("div",{className:"h-4 bg-gray-300 rounded w-24"}),e("div",{className:"h-4 bg-gray-300 rounded w-24"})]})}),[1,2,3,4,5].map(t=>e("div",{className:"p-4 border-b last:border-b-0",children:a("div",{className:"flex gap-4",children:[e("div",{className:"h-4 bg-gray-200 rounded w-32"}),e("div",{className:"h-4 bg-gray-200 rounded w-24"}),e("div",{className:"h-4 bg-gray-200 rounded w-24"})]})},t))]})]}),a("div",{className:"flex gap-3 pt-4",children:[e("div",{className:"h-12 bg-gray-200 rounded-xl w-32"}),e("div",{className:"h-12 bg-gray-200 rounded-xl w-32"})]})]})]})]})}function ot(){return a("div",{className:"p-4 md:p-6 animate-pulse",children:[a("div",{className:"mb-6",children:[e("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-2"}),e("div",{className:"h-4 bg-gray-100 rounded w-1/2"})]}),e("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100 max-w-2xl",children:a("div",{className:"space-y-6",children:[[1,2,3,4].map(t=>a("div",{children:[e("div",{className:"h-4 bg-gray-200 rounded w-32 mb-3"}),e("div",{className:"h-12 bg-gray-100 rounded-xl"})]},t)),e("div",{className:"border-2 border-dashed border-gray-200 rounded-xl p-8",children:a("div",{className:"text-center",children:[e("div",{className:"w-16 h-16 bg-gray-200 rounded-full mx-auto mb-4"}),e("div",{className:"h-5 bg-gray-200 rounded w-48 mx-auto mb-2"}),e("div",{className:"h-4 bg-gray-100 rounded w-64 mx-auto"})]})}),a("div",{className:"flex gap-3 pt-4",children:[e("div",{className:"h-12 bg-gray-300 rounded-xl flex-1"}),e("div",{className:"h-12 bg-gray-200 rounded-xl w-32"})]})]})})]})}function Ft(){return e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:e("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-pulse",children:a("div",{className:"max-w-6xl mx-auto",children:[a("div",{className:"text-center mb-8",children:[e("div",{className:"h-12 bg-gray-300 rounded w-96 mx-auto mb-4"}),e("div",{className:"h-5 bg-gray-200 rounded w-[500px] mx-auto mb-2"}),e("div",{className:"h-5 bg-gray-200 rounded w-[450px] mx-auto"})]}),a("div",{className:"flex gap-2 mb-6",children:[e("div",{className:"h-10 bg-gray-300 rounded-lg w-32"}),e("div",{className:"h-10 bg-gray-200 rounded-lg w-32"})]}),a("div",{className:"bg-white/60 backdrop-blur-sm p-4 rounded-xl mb-6 flex flex-wrap items-center justify-between gap-4",children:[a("div",{className:"flex gap-2",children:[e("div",{className:"h-10 bg-gray-300 rounded-lg w-28"}),e("div",{className:"h-10 bg-gray-200 rounded-lg w-28"})]}),a("div",{className:"flex gap-2",children:[e("div",{className:"h-10 bg-blue-200 rounded-lg w-36"}),e("div",{className:"h-10 bg-green-200 rounded-lg w-32"})]})]}),e("div",{className:"flex flex-wrap gap-2 mb-6",children:[1,2,3,4,5].map(t=>e("div",{className:"h-10 bg-gray-200 rounded-lg w-24"},t))}),e("div",{className:"space-y-4",children:[1,2,3].map(t=>a("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[a("div",{className:"p-6 pb-4",children:[a("div",{className:"flex items-start justify-between mb-3",children:[a("div",{className:"flex-1",children:[e("div",{className:"h-6 bg-gray-300 rounded w-48 mb-2"}),e("div",{className:"h-4 bg-gray-200 rounded w-64"})]}),e("div",{className:"h-8 bg-yellow-100 rounded-full w-32"})]}),e("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-4 mt-4",children:[1,2,3,4,5].map(r=>a("div",{children:[e("div",{className:"h-3 bg-gray-200 rounded w-16 mb-2"}),e("div",{className:"h-5 bg-gray-300 rounded w-20"})]},r))}),t===2&&a("div",{className:"mt-4 p-3 bg-orange-50 rounded-lg border border-orange-200",children:[e("div",{className:"h-4 bg-orange-200 rounded w-32 mb-2"}),e("div",{className:"h-4 bg-orange-100 rounded w-full"})]})]}),e("div",{className:"border-t border-gray-100"}),e("div",{className:"p-6 pt-4 bg-gray-50",children:a("div",{className:"flex flex-wrap gap-2",children:[e("div",{className:"h-10 bg-blue-200 rounded-lg w-32"}),e("div",{className:"h-10 bg-green-200 rounded-lg w-28"}),e("div",{className:"h-10 bg-gray-200 rounded-lg w-24"})]})})]},t))})]})})})}function nt(){return e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:e("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-pulse",children:a("div",{className:"max-w-6xl mx-auto",children:[a("div",{className:"text-center mb-8",children:[e("div",{className:"h-12 bg-gray-300 rounded w-96 mx-auto mb-4"}),e("div",{className:"h-5 bg-gray-200 rounded w-[450px] mx-auto"})]}),a("div",{className:"bg-white/60 backdrop-blur-sm p-6 md:p-8 rounded-3xl shadow-sm",children:[a("div",{className:"flex flex-wrap items-center gap-3 mb-6",children:[e("div",{className:"flex gap-2 flex-1",children:[1,2,3].map(t=>e("div",{className:"h-10 bg-gray-200 rounded-lg w-24"},t))}),a("div",{className:"flex gap-2",children:[e("div",{className:"h-10 bg-green-200 rounded-lg w-28"}),e("div",{className:"h-10 bg-orange-200 rounded-lg w-32"}),e("div",{className:"h-10 bg-red-200 rounded-lg w-28"})]})]}),e("div",{className:"space-y-4",children:[1,2,3].map(t=>a("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[a("div",{className:"p-6 pb-4",children:[a("div",{className:"flex items-start justify-between mb-3 gap-2",children:[a("div",{className:"flex-1",children:[e("div",{className:"h-6 bg-gray-300 rounded w-48 mb-2"}),a("div",{className:"flex items-center gap-2",children:[e("div",{className:"h-4 bg-gray-200 rounded w-40"}),e("div",{className:"h-5 bg-blue-100 rounded-full w-16"})]})]}),e("div",{className:"h-8 bg-yellow-100 rounded-full w-28"})]}),e("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[1,2,3,4].map(r=>a("div",{children:[e("div",{className:"h-3 bg-gray-200 rounded w-16 mb-2"}),e("div",{className:"h-5 bg-gray-300 rounded w-24"})]},r))})]}),e("div",{className:"border-t border-gray-100"}),e("div",{className:"p-6 pt-4 bg-gray-50",children:a("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[e("div",{className:"h-10 bg-green-200 rounded-lg"}),e("div",{className:"h-10 bg-red-200 rounded-lg"}),e("div",{className:"h-10 bg-yellow-200 rounded-lg"}),e("div",{className:"h-10 bg-gray-200 rounded-lg"})]})})]},t))})]})]})})})}function qt(){return e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:e("div",{className:"container mx-auto px-4 py-6 md:py-8 animate-pulse",children:a("div",{className:"max-w-7xl mx-auto",children:[e("div",{className:"mb-6 md:mb-8",children:e("div",{className:"bg-white/60 backdrop-blur-sm p-6 rounded-3xl shadow-sm",children:a("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[a("div",{className:"flex-1",children:[e("div",{className:"h-10 bg-gray-300 rounded w-80 mb-2"}),e("div",{className:"h-5 bg-gray-200 rounded w-96"})]}),e("div",{className:"grid grid-cols-2 sm:flex gap-3",children:[1,2,3,4].map(t=>a("div",{className:"bg-white/80 px-3 py-2 rounded-xl",children:[e("div",{className:"h-3 bg-gray-200 rounded w-16 mb-2"}),e("div",{className:"h-7 bg-gray-300 rounded w-12"})]},t))})]})})}),a("div",{className:"bg-white/60 backdrop-blur-sm p-6 md:p-8 rounded-3xl shadow-sm space-y-8",children:[e("div",{children:e("div",{className:"relative max-w-2xl",children:e("div",{className:"h-12 bg-gray-200 rounded-xl"})})}),a("div",{children:[e("div",{className:"h-6 bg-gray-300 rounded w-48 mb-4"}),e("div",{className:"flex flex-wrap gap-2",children:[1,2,3,4].map(t=>e("div",{className:"h-10 bg-gray-200 rounded-lg w-32"},t))})]}),a("div",{children:[e("div",{className:"h-6 bg-gray-300 rounded w-56 mb-4"}),e("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[1,2,3].map(t=>e("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:a("div",{className:"p-4",children:[a("div",{className:"flex items-center justify-between mb-2",children:[e("div",{className:"h-4 bg-gray-300 rounded w-32"}),e("div",{className:"h-4 w-4 bg-gray-200 rounded"})]}),e("div",{className:"h-8 bg-gray-300 rounded w-16 mb-2"}),e("div",{className:"h-4 bg-gray-200 rounded w-28"})]})},t))})]}),e("div",{className:"space-y-4",children:[1,2,3].map(t=>a("div",{className:"bg-white/80 rounded-xl p-6",children:[a("div",{className:"flex items-start justify-between mb-3",children:[a("div",{className:"flex-1",children:[e("div",{className:"h-6 bg-gray-300 rounded w-48 mb-2"}),e("div",{className:"h-4 bg-gray-200 rounded w-64"})]}),e("div",{className:"h-8 bg-gray-200 rounded-full w-24"})]}),e("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-4 mt-4",children:[1,2,3,4,5].map(r=>a("div",{children:[e("div",{className:"h-3 bg-gray-200 rounded w-16 mb-2"}),e("div",{className:"h-5 bg-gray-300 rounded w-20"})]},r))}),a("div",{className:"flex gap-2 mt-4",children:[e("div",{className:"h-10 bg-gray-200 rounded-lg w-24"}),e("div",{className:"h-10 bg-gray-200 rounded-lg w-32"})]})]},t))})]})]})})})}function Vt(){return a("div",{className:"p-4 md:p-6 animate-pulse",children:[a("div",{className:"flex justify-between items-center mb-6",children:[a("div",{children:[e("div",{className:"h-8 bg-gray-200 rounded w-48 mb-2"}),e("div",{className:"h-4 bg-gray-100 rounded w-64"})]}),a("div",{className:"flex gap-2",children:[e("div",{className:"h-10 bg-gray-200 rounded w-32"}),e("div",{className:"h-10 bg-gray-200 rounded w-24"})]})]}),e("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 mb-6",children:e("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[1,2,3].map(t=>a("div",{children:[e("div",{className:"h-4 bg-gray-200 rounded w-24 mb-2"}),e("div",{className:"h-10 bg-gray-100 rounded-xl"})]},t))})}),a("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[e("div",{className:"bg-gray-50 border-b border-gray-200",children:e("div",{className:"grid grid-cols-6 gap-4 p-4",children:[1,2,3,4,5,6].map(t=>e("div",{className:"h-4 bg-gray-300 rounded"},t))})}),[1,2,3,4,5,6,7].map(t=>e("div",{className:"border-b border-gray-100 last:border-b-0",children:e("div",{className:"grid grid-cols-6 gap-4 p-4",children:[1,2,3,4,5,6].map(r=>e("div",{className:"h-4 bg-gray-200 rounded"},r))})},t))]}),a("div",{className:"flex justify-between items-center mt-6",children:[e("div",{className:"h-4 bg-gray-200 rounded w-32"}),e("div",{className:"flex gap-2",children:[1,2,3].map(t=>e("div",{className:"h-10 w-10 bg-gray-200 rounded"},t))})]})]})}function Yt(){return e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:e("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-pulse",children:a("div",{className:"max-w-6xl mx-auto",children:[a("div",{className:"text-center mb-12",children:[e("div",{className:"w-20 h-20 bg-blue-100 rounded-full mx-auto mb-6"}),e("div",{className:"h-12 bg-gray-300 rounded w-96 mx-auto mb-4"}),e("div",{className:"h-5 bg-gray-200 rounded w-64 mx-auto mb-2"}),e("div",{className:"h-5 bg-gray-200 rounded w-80 mx-auto"})]}),e("div",{className:"space-y-8",children:[1,2,3,4].map(t=>a("div",{className:"bg-white/60 backdrop-blur-sm rounded-3xl shadow-2xl overflow-hidden",children:[e("div",{className:"bg-gradient-to-r ".concat(t%4===0?"from-blue-600 to-blue-700":t%4===1?"from-green-600 to-green-700":t%4===2?"from-purple-600 to-purple-700":"from-orange-600 to-orange-700"," px-6 py-6"),children:a("div",{className:"flex items-center gap-4",children:[e("div",{className:"w-8 h-8 bg-white/30 rounded"}),e("div",{className:"h-7 bg-white/30 rounded w-48"})]})}),e("div",{className:"divide-y divide-gray-200",children:[1,2,3].map(r=>a("div",{className:"p-6",children:[a("div",{className:"flex items-center justify-between mb-2",children:[e("div",{className:"h-5 bg-gray-300 rounded w-3/4"}),e("div",{className:"w-5 h-5 bg-gray-200 rounded"})]}),e("div",{className:"h-4 bg-gray-100 rounded w-full mt-3"}),e("div",{className:"h-4 bg-gray-100 rounded w-5/6 mt-2"})]},r))})]},t))})]})})})}function Jt(){return e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:e("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-pulse",children:a("div",{className:"max-w-6xl mx-auto",children:[a("div",{className:"text-center mb-12",children:[e("div",{className:"w-20 h-20 bg-blue-100 rounded-full mx-auto mb-6"}),e("div",{className:"h-12 bg-gray-300 rounded w-80 mx-auto mb-4"}),e("div",{className:"h-5 bg-gray-200 rounded w-64 mx-auto"})]}),e("div",{className:"bg-white/60 backdrop-blur-sm p-8 rounded-3xl shadow-2xl space-y-8",children:[{color:"blue"},{color:"green"},{color:"purple"},{color:"orange"},{color:"red"},{color:"indigo"}].map((t,r)=>a("div",{className:"border-l-4 border-".concat(t.color,"-500 pl-6"),children:[e("div",{className:"h-7 bg-gray-300 rounded w-64 mb-4"}),r===1||r===2?e("div",{className:"space-y-4",children:a("div",{className:"bg-".concat(t.color,"-50 p-5 rounded-xl"),children:[e("div",{className:"h-5 bg-gray-300 rounded w-48 mb-3"}),e("div",{className:"space-y-2",children:[1,2,3,4].map(s=>e("div",{className:"h-4 bg-gray-200 rounded w-full"},s))})]})}):a("div",{className:"space-y-3",children:[e("div",{className:"h-4 bg-gray-200 rounded w-full"}),e("div",{className:"h-4 bg-gray-200 rounded w-11/12"}),e("div",{className:"h-4 bg-gray-200 rounded w-5/6"})]})]},r))})]})})})}function Gt(){return e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:e("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-pulse",children:a("div",{className:"max-w-6xl mx-auto",children:[a("div",{className:"text-center mb-12",children:[e("div",{className:"w-20 h-20 bg-indigo-100 rounded-full mx-auto mb-6"}),e("div",{className:"h-12 bg-gray-300 rounded w-96 mx-auto mb-4"}),e("div",{className:"h-5 bg-gray-200 rounded w-64 mx-auto mb-2"}),e("div",{className:"h-5 bg-gray-200 rounded w-48 mx-auto"})]}),e("div",{className:"bg-white/60 backdrop-blur-sm p-8 rounded-3xl shadow-2xl space-y-8",children:[{color:"indigo",hasHighlight:!0},{color:"blue",hasCards:!0},{color:"green",hasBoxes:!0},{color:"purple",hasBoxes:!0},{color:"red"},{color:"orange"}].map((t,r)=>a("div",{className:"border-l-4 border-".concat(t.color,"-500 pl-6 ").concat(t.hasHighlight?"bg-indigo-50 rounded-r-lg py-4 pr-6":""),children:[e("div",{className:"h-7 bg-gray-300 rounded w-80 mb-4"}),t.hasCards?e("div",{className:"space-y-3",children:[1,2,3,4].map(s=>a("div",{className:"flex items-start gap-3 bg-".concat(t.color,"-50 p-4 rounded-lg border-l-4 border-").concat(t.color,"-400"),children:[e("div",{className:"w-6 h-6 bg-gray-300 rounded"}),e("div",{className:"flex-1 h-4 bg-gray-300 rounded"})]},s))}):t.hasBoxes?a("div",{className:"bg-".concat(t.color,"-50 border border-").concat(t.color,"-200 rounded-xl p-5"),children:[e("div",{className:"h-6 bg-gray-300 rounded w-48 mb-4"}),e("div",{className:"space-y-3",children:[1,2,3,4].map(s=>e("div",{className:"bg-white p-3 rounded-lg",children:e("div",{className:"h-4 bg-gray-200 rounded w-full"})},s))})]}):a("div",{className:"space-y-3",children:[e("div",{className:"h-4 bg-gray-200 rounded w-full"}),e("div",{className:"h-4 bg-gray-200 rounded w-11/12"}),e("div",{className:"h-4 bg-gray-200 rounded w-10/12"})]})]},r))})]})})})}function Xt(){return e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:e("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-pulse",children:a("div",{className:"max-w-6xl mx-auto",children:[a("div",{className:"text-center mb-12",children:[e("div",{className:"h-12 bg-gray-300 rounded w-64 mx-auto mb-4"}),e("div",{className:"h-5 bg-gray-200 rounded w-96 mx-auto mb-2"}),e("div",{className:"h-5 bg-gray-200 rounded w-80 mx-auto"})]}),a("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[a("div",{className:"bg-white/60 backdrop-blur-sm p-8 rounded-3xl shadow-2xl",children:[a("div",{className:"text-center",children:[e("div",{className:"w-20 h-20 bg-gray-200 rounded-full mx-auto mb-4"}),e("div",{className:"h-7 bg-gray-300 rounded w-48 mx-auto mb-4"}),a("div",{className:"space-y-2 mb-6",children:[e("div",{className:"h-4 bg-gray-200 rounded w-full"}),e("div",{className:"h-4 bg-gray-200 rounded w-5/6 mx-auto"}),e("div",{className:"h-4 bg-gray-200 rounded w-4/5 mx-auto"})]})]}),e("div",{className:"flex justify-center gap-4 mt-6",children:[1,2,3].map(t=>e("div",{className:"w-12 h-12 bg-gray-200 rounded-lg"},t))})]}),a("div",{className:"bg-white/60 backdrop-blur-sm p-8 rounded-3xl shadow-2xl",children:[a("div",{className:"text-center mb-6",children:[e("div",{className:"w-16 h-16 bg-green-100 rounded-full mx-auto mb-4"}),e("div",{className:"h-7 bg-gray-300 rounded w-32 mx-auto mb-6"})]}),e("div",{className:"space-y-4",children:[1,2,3].map(t=>a("div",{className:"flex items-center gap-3 p-3 rounded-xl bg-gray-100",children:[e("div",{className:"w-5 h-5 bg-gray-300 rounded"}),e("div",{className:"h-4 bg-gray-300 rounded w-32"})]},t))})]}),a("div",{className:"bg-white/60 backdrop-blur-sm p-8 rounded-3xl shadow-2xl",children:[a("div",{className:"text-center mb-6",children:[e("div",{className:"w-16 h-16 bg-purple-100 rounded-full mx-auto mb-4"}),e("div",{className:"h-7 bg-gray-300 rounded w-24 mx-auto mb-6"})]}),e("div",{className:"space-y-4",children:[1,2,3,4].map(t=>a("div",{className:"flex items-center gap-3 p-3 rounded-xl bg-gray-100",children:[e("div",{className:"w-5 h-5 bg-gray-300 rounded"}),e("div",{className:"h-4 bg-gray-300 rounded w-32"})]},t))})]})]})]})})})}function Kt(){return e("div",{className:"flex items-center justify-center min-h-[60vh] p-4 animate-pulse",children:a("div",{className:"text-center",children:[e("div",{className:"w-32 h-32 bg-gray-200 rounded-full mx-auto mb-6"}),e("div",{className:"h-10 bg-gray-300 rounded w-64 mx-auto mb-4"}),e("div",{className:"h-4 bg-gray-200 rounded w-96 mx-auto mb-8"}),e("div",{className:"h-12 bg-gray-300 rounded-xl w-48 mx-auto"})]})})}function Zt(){return e("div",{className:"min-h-screen flex items-center justify-center px-4 py-8",children:e("div",{className:"relative z-10 w-full max-w-md",children:a("div",{className:"backdrop-blur-md bg-white/20 border border-white/30 p-8 rounded-3xl shadow-2xl animate-pulse",children:[a("div",{className:"text-center mb-8",children:[e("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-white/30 rounded-full mb-6"}),e("div",{className:"h-9 bg-white/30 rounded-lg w-3/4 mx-auto mb-2"}),e("div",{className:"h-6 bg-white/20 rounded-lg w-2/3 mx-auto"})]}),a("div",{className:"space-y-6",children:[a("div",{children:[e("div",{className:"h-4 bg-white/30 rounded w-24 mb-3"}),e("div",{className:"h-14 bg-white/20 rounded-2xl"})]}),a("div",{children:[e("div",{className:"h-4 bg-white/30 rounded w-20 mb-3"}),e("div",{className:"h-14 bg-white/20 rounded-2xl"})]}),e("div",{className:"text-center",children:e("div",{className:"h-4 bg-white/20 rounded w-32 mx-auto"})}),e("div",{className:"pt-4",children:e("div",{className:"h-14 bg-white/30 rounded-2xl"})})]}),e("div",{className:"mt-8 text-center",children:e("div",{className:"h-4 bg-white/20 rounded w-48 mx-auto"})})]})})})}function Qt(){return e("div",{className:"min-h-screen flex items-center justify-center px-4 py-8",children:e("div",{className:"relative z-10 w-full max-w-md",children:a("div",{className:"backdrop-blur-md bg-white/20 border border-white/30 p-8 rounded-3xl shadow-2xl animate-pulse",children:[a("div",{className:"text-center mb-8",children:[e("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-white/30 rounded-full mb-6"}),e("div",{className:"h-9 bg-white/30 rounded-lg w-3/4 mx-auto mb-2"}),e("div",{className:"h-6 bg-white/20 rounded-lg w-2/3 mx-auto"})]}),a("div",{className:"space-y-6",children:[[1,2].map(t=>a("div",{children:[e("div",{className:"h-4 bg-white/30 rounded w-24 mb-3"}),e("div",{className:"h-14 bg-white/20 rounded-2xl"})]},t)),a("div",{className:"grid grid-cols-2 gap-4",children:[a("div",{children:[e("div",{className:"h-4 bg-white/30 rounded w-16 mb-3"}),e("div",{className:"h-14 bg-white/20 rounded-2xl"})]}),a("div",{children:[e("div",{className:"h-4 bg-white/30 rounded w-20 mb-3"}),e("div",{className:"h-14 bg-white/20 rounded-2xl"})]})]}),a("div",{className:"grid grid-cols-2 gap-4",children:[a("div",{children:[e("div",{className:"h-4 bg-white/30 rounded w-16 mb-3"}),e("div",{className:"h-14 bg-white/20 rounded-2xl"})]}),a("div",{children:[e("div",{className:"h-4 bg-white/30 rounded w-16 mb-3"}),e("div",{className:"h-14 bg-white/20 rounded-2xl"})]})]}),[1,2].map(t=>a("div",{children:[e("div",{className:"h-4 bg-white/30 rounded w-28 mb-3"}),e("div",{className:"h-14 bg-white/20 rounded-2xl"})]},"pass-".concat(t))),e("div",{className:"pt-4",children:e("div",{className:"h-14 bg-white/30 rounded-2xl"})})]}),e("div",{className:"mt-8 text-center",children:e("div",{className:"h-4 bg-white/20 rounded w-48 mx-auto"})})]})})})}class er extends pt.Component{constructor(r){super(r),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0}}componentDidCatch(r,s){console.error("Error caught by boundary:",r,s),this.setState({error:r,errorInfo:s})}render(){return this.state.hasError?e("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:a("div",{className:"max-w-md mx-auto text-center",children:[e("div",{className:"mb-4",children:e("svg",{className:"mx-auto h-12 w-12 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Oops! Something went wrong"}),e("p",{className:"text-gray-600 mb-4",children:"We're sorry, but there was an error loading the application."}),e("button",{onClick:()=>window.location.reload(),className:"bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded",children:"Reload Page"}),!1]})}):this.props.children}}function tr(t,r="Something went wrong. Please try again."){if(!t)return r;const s=t.data&&(t.data.error||t.data.message);if(typeof s=="string"&&s.trim())return s.trim();const o=t.status;if(o!=null){const p={400:"Invalid request. Please check your input and try again.",401:"Session expired or invalid. Please sign in again.",403:"You don't have permission to do this.",404:"The requested item was not found.",408:"Request timed out. Please try again.",409:"This action conflicts with current data. Please refresh and try again.",422:"The information provided could not be processed. Please check and try again.",429:"Too many requests. Please wait a moment and try again.",500:"Server error. Please try again in a few moments.",502:"Service temporarily unavailable. Please try again shortly.",503:"Service temporarily unavailable. Please try again shortly.",504:"Request timed out. The server is taking too long to respond."}[o];if(p)return p}const n=(t.message||"").toLowerCase();if(n.includes("fetch")||n.includes("network")||n.includes("failed to fetch")||n.includes("networkerror"))return"Connection failed. Please check your internet connection and try again.";if(n.includes("timeout")||n.includes("abort")||t.name==="AbortError")return"Request took too long. Please try again.";if(typeof t.message=="string"&&/^HTTP\s+\d{3}/.test(t.message.trim())){const l=o!=null?o:parseInt(String(t.message).replace(/^HTTP\s+(\d{3}).*/,"$1"),10);return isNaN(l)?r:l>=500?"Server error. Please try again in a few moments.":"Request failed. Please try again."}return r}const We=new Map,$e=new Map;function it(t){if(!t||t.startsWith("http://")||t.startsWith("https://"))return t;const r="https://academics-5bf1.onrender.com";return"".concat(r).concat(t)}async function De(t,r,s={}){const{cache:o=!0,ttl:n=30*1e3,timeout:l=30*1e3,dedupe:p=!0,retry:g=0,retryDelay:M=500,body:h,headers:N,raw:m=!1,responseType:f="json",dispatch:k=!0,dispatchEvent:_=null}=s,re=h&&!(h instanceof FormData)&&!m?JSON.stringify(h):h instanceof FormData?"[FormData]":"",$="".concat(t,":").concat(r,":").concat(re);if(o&&$e.has($)){const T=$e.get($);if(Date.now()-T.ts<(T.ttl||n))return T.data;$e.delete($)}if(p&&We.has($))return We.get($);const W=(async()=>{let T=0;for(;;){const B=new AbortController,J=setTimeout(()=>B.abort(),l);try{let x;const H={};h&&!(h instanceof FormData)&&!m?(x=JSON.stringify(h),H["Content-Type"]="application/json"):x=h;const se=Object.assign({},N||{},H),R=await fetch(it(r),{method:t,headers:se,body:x,signal:B.signal});if(clearTimeout(J),!R.ok){const V=await R.json().catch(()=>null),X=new Error;throw X.status=R.status,X.data=V,X.message=tr({...X,status:R.status,data:V},"Request failed. Please try again."),X}let G=null;f==="json"?G=await R.json().catch(()=>null):f==="blob"?G=await R.blob():f==="arrayBuffer"?G=await R.arrayBuffer():f==="text"&&(G=await R.text()),o&&f==="json"&&$e.set($,{ts:Date.now(),data:G,ttl:n});try{if(t!=="GET"&&k){let V=[];if(_)V=Array.isArray(_)?_:[_];else{const X=it(r).toLowerCase();X.includes("/api/marksheets")&&V.push("marksheetsUpdated"),X.includes("/api/leaves")&&V.push("notificationsUpdated"),X.includes("/api/staff-approval")&&V.push("notificationsUpdated"),X.includes("/api/notifications")&&V.push("notificationsUpdated"),X.includes("/api/whatsapp-dispatch")&&V.push("marksheetsUpdated","notificationsUpdated")}Array.from(new Set(V)).forEach(X=>{try{window.dispatchEvent(new Event(X))}catch(ve){}})}}catch(V){console.debug("apiClient dispatch error",V)}return G}catch(x){T+=1;const H=x&&(x.name==="AbortError"||x.message&&x.message.includes("aborted"));if(T>g||H&&T>g)throw x;const se=Math.max(0,M*Math.pow(2,T-1));await new Promise(R=>setTimeout(R,se))}}})();return We.set($,W),W.finally(()=>{try{We.delete($)}catch(T){}}),W}const U={get:(t,r)=>De("GET",t,r),post:(t,r,s={})=>De("POST",t,Object.assign({},s,{body:r})),put:(t,r,s={})=>De("PUT",t,Object.assign({},s,{body:r})),patch:(t,r,s={})=>De("PATCH",t,Object.assign({},s,{body:r})),del:(t,r)=>De("DELETE",t,r)};/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rr=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ar=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(r,s,o)=>o?o.toUpperCase():s.toLowerCase()),lt=t=>{const r=ar(t);return r.charAt(0).toUpperCase()+r.slice(1)},xt=(...t)=>t.filter((r,s,o)=>!!r&&r.trim()!==""&&o.indexOf(r)===s).join(" ").trim(),sr=t=>{for(const r in t)if(r.startsWith("aria-")||r==="role"||r==="title")return!0};/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var or={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nr=i.forwardRef(({color:t="currentColor",size:r=24,strokeWidth:s=2,absoluteStrokeWidth:o,className:n="",children:l,iconNode:p,...g},M)=>i.createElement("svg",{ref:M,...or,width:r,height:r,stroke:t,strokeWidth:o?Number(s)*24/Number(r):s,className:xt("lucide",n),...!l&&!sr(g)&&{"aria-hidden":"true"},...g},[...p.map(([h,N])=>i.createElement(h,N)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=(t,r)=>{const s=i.forwardRef(({className:o,...n},l)=>i.createElement(nr,{ref:l,iconNode:r,className:xt("lucide-".concat(rr(lt(t))),"lucide-".concat(t),o),...n}));return s.displayName=lt(t),s};/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ir=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],Je=ye("bell",ir);/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lr=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],cr=ye("circle-alert",lr);/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dr=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],_e=ye("circle-check-big",dr);/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ur=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],mr=ye("circle-x",ur);/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hr=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],qe=ye("clock",hr);/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gr=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],fr=ye("info",gr);/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pr=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],br=ye("triangle-alert",pr);/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vr=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Ge=ye("user-check",vr);/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wr=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],ct=ye("user-x",wr);/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xr=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Be=ye("x",xr);function yr({type:t="info",title:r,message:s,onClose:o,autoClose:n=!0,duration:l=5e3,position:p="top-right"}){i.useEffect(()=>{if(n&&o){const _=setTimeout(o,l);return()=>clearTimeout(_)}},[n,l,o]);const g=_=>{_.preventDefault(),_.stopPropagation(),o&&o()},M={success:e(_e,{className:"w-5 h-5 sm:w-6 sm:h-6 text-green-500"}),error:e(cr,{className:"w-5 h-5 sm:w-6 sm:h-6 text-red-500"}),warning:e(br,{className:"w-5 h-5 sm:w-6 sm:h-6 text-amber-500"}),info:e(fr,{className:"w-5 h-5 sm:w-6 sm:h-6 text-blue-500"})},h={success:"bg-gradient-to-br from-green-50 to-emerald-50",error:"bg-gradient-to-br from-red-50 to-rose-50",warning:"bg-gradient-to-br from-amber-50 to-yellow-50",info:"bg-gradient-to-br from-blue-50 to-cyan-50"},N={success:"border-green-300",error:"border-red-300",warning:"border-amber-300",info:"border-blue-300"},m={success:"bg-green-100",error:"bg-red-100",warning:"bg-amber-100",info:"bg-blue-100"},f={success:"from-green-500 to-emerald-500",error:"from-red-500 to-rose-500",warning:"from-amber-500 to-yellow-500",info:"from-blue-500 to-cyan-500"},k={"top-right":"notification-container notification-top-right","top-left":"notification-container notification-top-left","top-center":"notification-container notification-top-center","bottom-right":"notification-container notification-bottom-right","bottom-left":"notification-container notification-bottom-left","bottom-center":"notification-container notification-bottom-center",center:"notification-container notification-center"};return e("div",{className:"".concat(k[p]),children:a("div",{role:"alert",className:"\n          notification-card notification-interactive\n          relative w-11/12 sm:min-w-[340px] sm:max-w-md \n          rounded-lg sm:rounded-2xl\n          ".concat(h[t],"\n          border-2 ").concat(N[t],"\n          p-2.5 sm:p-5\n          shadow-xl\n          backdrop-blur-md\n          transform-gpu\n        "),style:{boxSizing:"border-box"},children:[o&&e("button",{type:"button",onClick:g,onTouchEnd:g,className:"absolute top-2 right-2 sm:top-3 sm:right-3 z-10\n                     p-1 sm:p-1.5 rounded-lg\n                     bg-white/90 hover:bg-white active:bg-gray-100\n                     border border-gray-300\n                     transition-all duration-200 \n                     hover:scale-110 active:scale-95\n                     shadow-md hover:shadow-lg\n                     cursor-pointer\n                     touch-manipulation","aria-label":"Close alert",style:{touchAction:"manipulation",WebkitTapHighlightColor:"transparent",minWidth:"32px",minHeight:"32px",display:"flex",alignItems:"center",justifyContent:"center"},children:e(Be,{className:"w-4 h-4 sm:w-4 sm:h-4 text-gray-700 stroke-2"})}),a("div",{className:"flex items-start gap-2.5 sm:gap-4 pr-9 sm:pr-11",children:[e("div",{className:"flex-shrink-0 p-1.5 sm:p-2 rounded-lg ".concat(m[t]),children:M[t]}),a("div",{className:"flex-1 min-w-0 pt-0.5",children:[r&&e("h3",{className:"text-gray-900 font-bold text-sm sm:text-base mb-1 \n                           break-words leading-tight",children:r}),s&&e("p",{className:"text-gray-700 text-xs sm:text-sm leading-relaxed \n                          break-words",children:s})]})]}),n&&e("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gray-200/50 overflow-hidden",style:{borderRadius:"0 0 12px 12px"},children:e("div",{className:"h-full bg-gradient-to-r ".concat(f[t]," shadow-sm"),style:{animation:"progress ".concat(l,"ms linear forwards"),transformOrigin:"left"}})})]})})}const yt=i.createContext();function Nr({children:t}){const[r,s]=i.useState([]),o=i.useCallback(({type:h="info",title:N,message:m,duration:f=5e3,position:k="top-right",autoClose:_=!0})=>{const re=Date.now()+Math.random();return s($=>[...$,{id:re,type:h,title:N,message:m,duration:f,position:k,autoClose:_}]),re},[]),n=i.useCallback(h=>{s(N=>N.filter(m=>m.id!==h))},[]),l=i.useCallback((h,N,m={})=>o({type:"success",title:h,message:N,...m}),[o]),p=i.useCallback((h,N,m={})=>o({type:"error",title:h,message:N,...m}),[o]),g=i.useCallback((h,N,m={})=>o({type:"warning",title:h,message:N,...m}),[o]),M=i.useCallback((h,N,m={})=>o({type:"info",title:h,message:N,...m}),[o]);return i.useEffect(()=>{const h=N=>{var m;try{const f=((m=N==null?void 0:N.detail)==null?void 0:m.reason)||"";let k=null;k=M("Update available",a("div",{className:"flex items-center gap-3",children:[e("span",{children:"New version available ‚Äî reload to apply the update."}),e("button",{onClick:()=>{try{window.location.reload()}catch($){}k&&n(k)},className:"ml-3 px-3 py-1 bg-blue-600 text-white rounded-md text-xs",children:"Reload"})]}),{autoClose:!1,duration:0,position:"top-right"})}catch(f){}};return window.addEventListener("sw:reload-request",h),()=>window.removeEventListener("sw:reload-request",h)},[M,n]),i.useEffect(()=>{const h=N=>{var m;try{const f=((m=N==null?void 0:N.detail)==null?void 0:m.message)||"Authentication failed. Check credentials.";p("Login failed",f)}catch(f){}};return window.addEventListener("api:auth-failed",h),()=>window.removeEventListener("api:auth-failed",h)},[p]),a(yt.Provider,{value:{showAlert:o,hideAlert:n,showSuccess:l,showError:p,showWarning:g,showInfo:M},children:[t,r.map(h=>e(yr,{type:h.type,title:h.title,message:h.message,duration:h.duration,position:h.position,autoClose:h.autoClose,onClose:()=>n(h.id)},h.id))]})}function kr(){const t=i.useContext(yt);if(!t)throw new Error("useAlert must be used within AlertProvider");return t}class Sr{constructor(){this.registration=null,this.subscription=null}isSupported(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window}getPermission(){return this.isSupported()?Notification.permission:"unsupported"}async requestPermission(){if(!this.isSupported())return console.warn("Push notifications are not supported in this browser"),alert("‚ö†Ô∏è Your browser does not support notifications.\n\nPlease use Chrome, Edge, or Firefox."),!1;try{if(Notification.permission==="granted")return console.log("‚úÖ Notification permission already granted"),!0;if(Notification.permission==="denied"){console.warn("‚ùå Notifications are blocked. Please enable them in browser settings.");const s=navigator.userAgent.includes("Chrome")&&!navigator.userAgent.includes("Edge"),o=navigator.userAgent.includes("Edg");let n="‚ùå Notifications are blocked!\n\nTo enable notifications:\n\n";return o?(n+="1. Click the üîí lock icon in the address bar\n",n+='2. Click "Permissions for this site"\n',n+='3. Find "Notifications" and select "Allow"\n',n+="4. Refresh the page"):s?(n+="1. Click the üîí lock icon in the address bar\n",n+='2. Click "Site settings"\n',n+='3. Find "Notifications" and select "Allow"\n',n+="4. Refresh the page"):n+="Go to Settings > Privacy > Notifications\nand allow notifications for this site.",alert(n),!1}console.log("üì¢ Requesting notification permission...");const r=await Notification.requestPermission();return console.log("Notification permission result:",r),r==="granted"?(console.log("‚úÖ Notification permission granted!"),(navigator.platform.includes("Win")||navigator.userAgent.includes("Windows"))&&(console.log("ü™ü Windows detected - sending test notification..."),setTimeout(()=>{this.showTestNotification()},500)),!0):r==="denied"?(console.warn("‚ùå User denied notification permission"),alert("‚ö†Ô∏è Notifications were blocked.\n\nYou won't receive event reminders.\nYou can enable them later in Settings."),!1):(console.log("‚ÑπÔ∏è User dismissed notification permission request"),!1)}catch(r){return console.error("‚ùå Error requesting notification permission:",r),alert("‚ö†Ô∏è Error enabling notifications: "+r.message),!1}}showTestNotification(){if(Notification.permission==="granted")try{const r=new Notification("üéâ Notifications Enabled!",{body:"MSEC Academics notifications are working!\nYou will receive event reminders here.",icon:"/images/android-chrome-192x192.png",badge:"/images/favicon-32x32.png",tag:"test-notification-"+Date.now(),requireInteraction:!1,silent:!1,timestamp:Date.now(),vibrate:[200,100,200],renotify:!0,dir:"auto",lang:"en-US"});r.onclick=function(s){s.preventDefault(),window.focus(),r.close()},setTimeout(()=>{r.close()},5e3),console.log("‚úÖ Test notification sent successfully")}catch(r){console.error("‚ùå Error showing test notification:",r),this.registration&&this.registration.showNotification("üéâ Notifications Enabled!",{body:"MSEC Academics notifications are working!",icon:"/images/android-chrome-192x192.png",tag:"test-notification-"+Date.now()})}}async registerServiceWorker(){if(!("serviceWorker"in navigator))return console.warn("Service Worker not supported"),null;try{const r=await navigator.serviceWorker.register("/service-worker.js",{scope:"/"});return console.log("Service Worker registered:",r),this.registration=r,await navigator.serviceWorker.ready,console.log("Service Worker is ready"),r}catch(r){return console.error("Service Worker registration failed:",r),null}}async getVapidPublicKey(){try{const r=await U.get("/api/notifications/vapid-public-key");return r&&r.publicKey?r.publicKey:(console.warn("Failed to fetch VAPID key from server, using fallback"),"BI3ZQwdtuxxYpepMvZjy5xkuzLbnsjG8J1jfBkGMi0AzbhWDocIASZkq6ocisfwCTnYCHuogo_O-PJSuyfGWwkU")}catch(r){return console.error("Error fetching VAPID key:",r),"BI3ZQwdtuxxYpepMvZjy5xkuzLbnsjG8J1jfBkGMi0AzbhWDocIASZkq6ocisfwCTnYCHuogo_O-PJSuyfGWwkU"}}async subscribe(){if(this.registration||await this.registerServiceWorker(),!this.registration)return console.error("Service Worker registration required"),null;try{let r=localStorage.getItem("userEmail");if(!r){const o=localStorage.getItem("auth");if(o)try{r=JSON.parse(o).email}catch(n){}}if(!r)return alert("Please login again to enable notifications"),null;let s=await this.registration.pushManager.getSubscription();if(!s){const o=await this.getVapidPublicKey();s=await this.registration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this.urlBase64ToUint8Array(o)})}return this.subscription=s,await this.sendSubscriptionToServer(s,r),this.setUserPrefEnabled(!0),s}catch(r){return console.error("‚ùå Failed to subscribe to push notifications:",r),null}}async unsubscribe(){if(!this.subscription){const r=await navigator.serviceWorker.ready;this.subscription=await r.pushManager.getSubscription()}if(this.subscription)try{return await this.subscription.unsubscribe(),await this.removeSubscriptionFromServer(this.subscription),this.subscription=null,this.setUserPrefEnabled(!1),!0}catch(r){return console.error("Failed to unsubscribe:",r),!1}return this.setUserPrefEnabled(!1),!1}async sendSubscriptionToServer(r,s=null){var o;try{if(!s&&(s=localStorage.getItem("userEmail"),!s)){const l=localStorage.getItem("auth");if(l)try{s=JSON.parse(l).email}catch(p){console.error("Error parsing auth data:",p)}}if(console.log("üíæ Sending subscription to server...",{hasSubscription:!!r,userEmail:s,endpoint:((o=r==null?void 0:r.endpoint)==null?void 0:o.substring(0,50))+"..."}),!s)return console.error("‚ùå No userEmail found in localStorage"),alert("Please login again to enable push notifications."),!1;const n=await U.post("/api/notifications/subscribe",{subscription:r,userEmail:s});return console.log("‚úÖ Subscription sent to server successfully:",n),n&&n.message&&n.message.includes("reassigned")&&console.log("üîÑ This browser subscription was reassigned from a previous user"),n&&(n.success===void 0||n.success)?!0:(console.error("‚ùå Failed to send subscription to server:",n),!1)}catch(n){return console.error("‚ùå Error sending subscription to server:",n),!1}}async removeSubscriptionFromServer(r){var s;try{let o=localStorage.getItem("userEmail");if(!o){const n=localStorage.getItem("auth");if(n)try{o=JSON.parse(n).email}catch(l){console.error("Error parsing auth data:",l)}}if(console.log("Removing subscription from server...",{hasSubscription:!!r,userEmail:o,endpoint:((s=r==null?void 0:r.endpoint)==null?void 0:s.substring(0,50))+"..."}),!o)return console.error("No userEmail found in localStorage"),!1;try{const n=await U.post("/api/notifications/unsubscribe",{endpoint:r.endpoint,userEmail:o});return console.log("Subscription removed from server successfully",n),!0}catch(n){return console.error("Failed to remove subscription:",n),!1}}catch(o){return console.error("Error removing subscription from server:",o),!1}}async showLocalNotification(r,s={}){try{if(this.registration||(console.log("No service worker registration, attempting to register..."),await this.registerServiceWorker()),Notification.permission!=="granted"&&(console.log("Notification permission not granted, requesting..."),!await this.requestPermission()))throw console.warn("Notification permission denied"),new Error("Notification permission denied");const n={...{body:"",icon:"/images/android-chrome-192x192.png",badge:"/images/favicon-32x32.png",vibrate:[200,100,200],tag:"msec-notification-"+Date.now(),requireInteraction:!1,data:{},timestamp:Date.now()},...s};if(this.registration&&this.registration.showNotification)console.log("Using service worker showNotification"),await this.registration.showNotification(r,n);else if("serviceWorker"in navigator){console.log("Attempting to get service worker registration...");const l=await navigator.serviceWorker.getRegistration();if(l)console.log("Found service worker registration, using showNotification"),await l.showNotification(r,n);else if(console.log("No service worker found, using direct Notification API"),"Notification"in window)new Notification(r,n);else throw new Error("Notifications not supported")}else if(console.log("Service worker not supported, using direct Notification API"),"Notification"in window)new Notification(r,n);else throw new Error("Notifications not supported");console.log("Notification displayed successfully")}catch(o){throw console.error("Error showing notification:",o),o}}urlBase64ToUint8Array(r){const s="=".repeat((4-r.length%4)%4),o=(r+s).replace(/\-/g,"+").replace(/_/g,"/"),n=window.atob(o),l=new Uint8Array(n.length);for(let p=0;p<n.length;++p)l[p]=n.charCodeAt(p);return l}getUserPrefEnabled(){try{const r=localStorage.getItem("auth"),s=localStorage.getItem("userEmail")||(r?JSON.parse(r).email:null);if(!s)return null;const o="notifications:".concat(s,":enabled"),n=localStorage.getItem(o);return n===null?null:n==="true"}catch(r){return null}}setUserPrefEnabled(r){try{const s=localStorage.getItem("auth"),o=localStorage.getItem("userEmail")||(s?JSON.parse(s).email:null);if(!o)return;const n="notifications:".concat(o,":enabled");localStorage.setItem(n,r?"true":"false")}catch(s){}}async initialize(){var r;if(!this.isSupported())return console.warn("Push notifications not supported"),!1;try{await this.registerServiceWorker();const s=this.getUserPrefEnabled();if(Notification.permission==="granted"){const o=await((r=this.registration)==null?void 0:r.pushManager.getSubscription());return o&&(this.subscription=o,s===!0?await this.sendSubscriptionToServer(o):console.log("Skipping auto-resync due to user preference OFF")),!0}return!1}catch(s){return console.error("Error initializing notifications:",s),!1}}async checkCurrentSubscription(){this.registration||await this.registerServiceWorker();try{const r=await this.registration.pushManager.getSubscription();if(!r)return console.log("‚ÑπÔ∏è No push subscription exists in this browser"),{found:!1};const s=await U.post("/api/subscription-check",{endpoint:r.endpoint});return s.found?(console.log("üîç This browser is subscribed as: ".concat(s.userEmail)),{found:!0,userEmail:s.userEmail,active:s.active,endpoint:r.endpoint}):(console.log("üîç This subscription is not registered to any user"),{found:!1})}catch(r){return console.error("‚ùå Error checking subscription:",r),{error:r.message}}}async handleLogout(){var r;try{let s=localStorage.getItem("userEmail");if(!s){const n=localStorage.getItem("auth");if(n)try{s=JSON.parse(n).email}catch(l){}}if(!s)return console.log("‚ùì No user email found during logout"),!1;try{await U.post("/api/notifications/deactivate",{userEmail:s}).catch(()=>{})}catch(n){}this.registration||await this.registerServiceWorker();const o=await((r=this.registration)==null?void 0:r.pushManager.getSubscription());if(o)try{await U.post("/api/notifications/deactivate",{userEmail:s,endpoint:o.endpoint}).catch(()=>{})}catch(n){}return this.subscription=null,!0}catch(s){return console.error("‚ùå Error in handleLogout:",s),!1}}}const Le=new Sr,Er=()=>Le.requestPermission(),Ve=()=>Le.subscribe(),dt=()=>Le.unsubscribe(),Cr=()=>Le.isSupported(),_r=()=>Le.getPermission(),Lr=()=>Le.checkCurrentSubscription();function Ir({isOpen:t,onClose:r,userEmail:s,userRole:o,isMobile:n=!1}){const l=bt(),{showSuccess:p,showError:g,showWarning:M,showInfo:h}=kr(),N=i.useRef(null),m=i.useRef(null),f=i.useRef(null),k=i.useRef(!0),[_,re]=i.useState(()=>typeof window>"u"?!1:window.matchMedia("(max-width: 768px)").matches),$=n||_,[W,T]=i.useState(!1),[B,J]=i.useState(!0),[x]=i.useState(()=>Cr()),[H,se]=i.useState(()=>typeof window<"u"&&"Notification"in window?Notification.permission:"default"),[R,G]=i.useState(!1),[V,X]=i.useState(!1),[ve,ne]=i.useState("draw"),[pe,u]=i.useState(null),[y,E]=i.useState(!1),[S,ie]=i.useState(!1),[L,Z]=i.useState(""),[d,w]=i.useState(""),[j,O]=i.useState(""),[de,b]=i.useState(""),[be,le]=i.useState(!1),[v,F]=i.useState(!1);i.useState(0),i.useRef(W);const P=i.useRef(!1);i.useEffect(()=>(k.current=!0,()=>{k.current=!1}),[]),i.useEffect(()=>{if((n||_)&&t){const c=document.body.style.overflow||"";return document.body.style.overflow="hidden",()=>{document.body.style.overflow=c||""}}},[t,n,_]),i.useEffect(()=>{if(!t)return;let c=!1;return F(!0),(async()=>{try{let C="default";x&&("Notification"in window?C=Notification.permission:C=_r()),console.log("Current notification permission:",C),c||se(C);const ee=localStorage.getItem("userSettings");let oe=!1;if(ee){const ge=JSON.parse(ee);oe=ge.notificationsEnabled===!0,console.log("Loaded user preference:",oe),c||(J(ge.emailNotifications!==!1),T(oe))}else console.log("New user - defaulting notifications to OFF"),c||(T(!1),localStorage.setItem("userSettings",JSON.stringify({notificationsEnabled:!1,emailNotifications:!0})));try{const ge=await Lr(),ce=(ge==null?void 0:ge.found)===!0;console.log("Current subscription status:",ce,"| User wants:",oe),oe&&!ce&&C==="granted"?(console.log("Creating missing subscription..."),await Ve()):!oe&&ce&&(console.log("Removing unwanted subscription..."),await dt())}catch(ge){console.error("Error syncing subscription:",ge)}}catch(C){console.error("Error loading settings:",C)}finally{c||F(!1)}})(),()=>{c=!0}},[t,x]),i.useEffect(()=>{if($)return;const c=I=>{N.current&&!N.current.contains(I.target)&&(v||r())};return t&&document.addEventListener("mousedown",c),()=>{document.removeEventListener("mousedown",c)}},[t,r,$,v]),i.useEffect(()=>{if($)return;const c=I=>{I.key==="Escape"&&t&&r()};return t&&document.addEventListener("keydown",c),()=>{document.removeEventListener("keydown",c)}},[t,r,$]);const q=async()=>{if(P.current){console.log("Toggle already in progress, ignoring...");return}if(R||!x||v){console.log("Toggle blocked: loading=",R,"supported=",x,"initializing=",v);return}const c=!W;console.log("Toggle clicked - changing from",W,"to",c),T(c),z("notificationsEnabled",c),P.current=!0,G(!0);try{if(c){console.log("Enabling notifications...");const I="Notification"in window?Notification.permission:"default";if(console.log("Current browser permission:",I),I==="granted"){console.log("Permission already granted, subscribing..."),se("granted");const C=await Ve();C?(console.log("Subscription successful:",C),p("Notifications Enabled","Push notifications activated!")):(console.error("Subscription returned null"),T(!1),z("notificationsEnabled",!1),g("Subscription Failed","Unable to subscribe to notifications. Try again."))}else if(I==="denied")console.log("Permission denied by browser"),T(!1),z("notificationsEnabled",!1),se("denied"),g("Permission Blocked","Please enable notifications in your browser settings");else if(console.log("Requesting permission..."),await Er()){se("granted");const ee=await Ve();ee?(console.log("Subscription successful:",ee),p("Notifications Enabled","Push notifications activated!")):(console.error("Subscription returned null"),T(!1),z("notificationsEnabled",!1),g("Subscription Failed","Unable to subscribe to notifications. Try again."))}else console.log("Permission request denied"),T(!1),z("notificationsEnabled",!1),se("denied"),g("Permission Blocked","Please enable notifications in your browser settings")}else{console.log("Disabling notifications...");const I=await dt();console.log("Unsubscribe result:",I),h("Notifications Disabled","Push notifications turned off")}}catch(I){console.error("Notification toggle error:",I),T(!c),z("notificationsEnabled",!c),g("Error","Failed to update notification settings")}finally{G(!1),P.current=!1}},D=()=>{const c=!B;J(c),z("emailNotifications",c)},z=(c,I)=>{const C=JSON.parse(localStorage.getItem("userSettings")||"{}");C[c]=I,localStorage.setItem("userSettings",JSON.stringify(C))},ae=async()=>{if(b(""),!L||!d||!j){b("All fields are required");return}if(d!==j){b("New passwords do not match");return}if(d.length<6){b("New password must be at least 6 characters");return}le(!0);try{const c=localStorage.getItem("userId");if(!c){b("Session expired. Please log out and log in again.");return}const I=await U.patch("/api/users?action=reset-password&userId=".concat(c),{currentPassword:L,newPassword:d});if(!I||!I.success){b((I==null?void 0:I.error)||"Failed to reset password");return}p("Success","Password changed successfully!"),Q()}catch(c){console.error("Password reset error:",c),b("Error: "+c.message)}finally{le(!1)}},Q=()=>{ie(!1),Z(""),w(""),O(""),b("")},me=(c,I)=>c.touches&&c.touches[0]?{x:c.touches[0].clientX-I.left,y:c.touches[0].clientY-I.top}:{x:c.clientX-I.left,y:c.clientY-I.top},A=c=>{c.preventDefault(),E(!0);const I=m.current.getBoundingClientRect(),C=m.current.getContext("2d"),ee=me(c,I);C.beginPath(),C.moveTo(ee.x,ee.y)},we=c=>{if(!y)return;c.preventDefault();const I=m.current.getBoundingClientRect(),C=m.current.getContext("2d"),ee=me(c,I);C.lineTo(ee.x,ee.y),C.stroke()},Ce=c=>{c&&c.preventDefault(),E(!1)},Te=c=>{var ee;const I=(ee=c.target.files)==null?void 0:ee[0];if(!I)return;if(I.size>2*1024*1024){g("File too large","Maximum 2MB allowed");return}const C=new FileReader;C.onload=oe=>{const ge=new Image;ge.onload=()=>{const ce=document.createElement("canvas");ce.width=ge.width,ce.height=ge.height;const je=ce.getContext("2d");je.fillStyle="#FFFFFF",je.fillRect(0,0,ce.width,ce.height),je.drawImage(ge,0,0);const Ae=je.getImageData(0,0,ce.width,ce.height).data;let Ne=ce.width,ke=ce.height,Se=0,Ee=0;for(let he=0;he<Ae.length;he+=4){const Pe=Ae[he],It=Ae[he+1],Rt=Ae[he+2],At=Ae[he+3];if((Pe<250||It<250||Rt<250)&&At>128){const Qe=he/4,et=Qe%ce.width,tt=Math.floor(Qe/ce.width);Ne=Math.min(Ne,et),ke=Math.min(ke,tt),Se=Math.max(Se,et),Ee=Math.max(Ee,tt)}}const Oe=10;if(Ne=Math.max(0,Ne-Oe),ke=Math.max(0,ke-Oe),Se=Math.min(ce.width,Se+Oe),Ee=Math.min(ce.height,Ee+Oe),Ne<Se&&ke<Ee){const he=document.createElement("canvas");he.width=Se-Ne,he.height=Ee-ke;const Pe=he.getContext("2d");Pe.fillStyle="#FFFFFF",Pe.fillRect(0,0,he.width,he.height),Pe.drawImage(ce,Ne,ke,Se-Ne,Ee-ke,0,0,he.width,he.height),u(he.toDataURL("image/png"))}else u(ce.toDataURL("image/png"))},ge.src=oe.target.result},C.readAsDataURL(I)},Re=()=>{m.current&&m.current.getContext("2d").clearRect(0,0,m.current.width,m.current.height),u(null),f.current&&(f.current.value="")},Me=async()=>{var I;const c=ve==="draw"?(I=m.current)==null?void 0:I.toDataURL("image/png"):pe;if(!c){g("No signature","Please draw or upload a signature");return}try{const C=JSON.parse(localStorage.getItem("auth")||"{}"),ee=(C==null?void 0:C.id)||localStorage.getItem("userId");if(C.eSignature=c,localStorage.setItem("auth",JSON.stringify(C)),ee)try{const oe=await U.patch("/api/users?action=update-signature&userId=".concat(ee),{eSignature:c});(!oe||!oe.success)&&console.warn("Could not persist signature to backend:",oe==null?void 0:oe.error)}catch(oe){console.warn("Backend signature save failed:",oe&&oe.message?oe.message:oe)}try{window.dispatchEvent(new Event("authStateChanged"))}catch(oe){}p("Saved","Signature saved successfully!"),X(!1),ne("draw"),u(null)}catch(C){console.error("Signature save error:",C),g("Error","Failed to save signature")}},Ze=()=>{X(!1),ne("draw"),u(null),Re()},St=()=>{try{r()}catch(c){console.error("Error closing modal:",c)}localStorage.removeItem("auth"),localStorage.removeItem("isLoggedIn"),localStorage.removeItem("userEmail"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),window.dispatchEvent(new Event("authStateChanged"));try{l("/login")}catch(c){window.location.href="/login"}},Et=c=>{c.stopPropagation(),c.preventDefault(),window.location.href="mailto:support@msecacademics.edu?subject=MSEC Academics Support",setTimeout(()=>{r()},300)};if(!t)return null;const Ct=()=>{const c=(()=>{if(o==="student")try{const C=JSON.parse(localStorage.getItem("auth")||"{}");return(C==null?void 0:C.name)||s}catch(C){return s}return s})(),I=(()=>{var C;if(o==="student")try{const ee=JSON.parse(localStorage.getItem("auth")||"{}");return((C=ee==null?void 0:ee.name)==null?void 0:C.charAt(0).toUpperCase())||"S"}catch(ee){return"S"}return(s==null?void 0:s.charAt(0).toUpperCase())||"?"})();return a(fe,{children:[e("button",{type:"button",onClick:C=>{C.stopPropagation(),v||r()},className:"absolute z-10 w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-200 active:bg-gray-300 transition-colors touch-manipulation ".concat(_?"top-3 right-3 sm:top-4 sm:right-4":"top-3 right-3"),"aria-label":"Close settings",style:{touchAction:"manipulation",boxSizing:"border-box"},children:e("svg",{className:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})}),e("div",{className:"px-4 sm:px-4 py-3 sm:py-4 border-b border-[#e7edf4] hover:bg-gray-50/50 transition-colors duration-200",children:a("div",{className:"flex items-center gap-3 pr-6",children:[e("div",{className:"w-10 h-10 rounded-full bg-white flex items-center justify-center flex-shrink-0 group-hover:shadow-md group-hover:scale-105 transition-all duration-200",children:e("span",{className:"text-base font-bold text-yellow-600 group-hover:text-yellow-700 transition-colors duration-200",children:I})}),a("div",{className:"flex-1 min-w-0",children:[e("h3",{className:"text-[#0b1220] font-semibold text-sm truncate group-hover:text-black transition-colors duration-200",children:c}),a("p",{className:"text-[#475569] text-xs capitalize group-hover:text-[#374151] transition-colors duration-200",children:[o," Account"]})]})]})})]})},_t=()=>a("div",{className:"px-3 sm:px-4 py-3 sm:py-4 space-y-4 sm:space-y-5 flex-1 overflow-y-auto overflow-x-hidden smooth-scroll settings-content",style:{WebkitOverflowScrolling:"touch",overscrollBehavior:"contain",touchAction:"pan-y",WebkitTapHighlightColor:"transparent",scrollBehavior:"smooth",width:"100%",boxSizing:"border-box"},children:[o!=="student"&&a("div",{children:[a("h4",{className:"text-sm font-semibold text-[#111418] group-hover:text-[#0b1220] mb-2 flex items-center gap-2 transition-colors duration-200",children:[e("svg",{className:"w-4 h-4 group-hover:text-yellow-600 transition-colors duration-200",fill:"currentColor",viewBox:"0 0 20 20",children:e("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})}),"Account"]}),a("div",{className:"space-y-2",children:[a("button",{type:"button",onClick:c=>{c.stopPropagation(),X(!0)},className:"w-full flex items-center gap-3 p-3 rounded-lg bg-white/6 hover:bg-white/12 hover:shadow-sm active:bg-white/5 transition-all duration-200 text-left min-h-[52px] cursor-pointer group",style:{touchAction:"manipulation",pointerEvents:"auto"},children:[e("svg",{className:"w-4 h-4 text-[#60758a] group-hover:text-[#4a5568] flex-shrink-0 transition-colors duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),a("div",{className:"flex-1 min-w-0",children:[e("p",{className:"text-sm font-medium text-[#111418] group-hover:text-[#0b1220] transition-colors duration-200",children:"Add Signature"}),e("p",{className:"text-xs text-[#60758a] group-hover:text-[#4a5568] mt-0.5 transition-colors duration-200",children:"Draw your digital signature for PDFs"})]}),e("svg",{className:"w-4 h-4 text-[#60758a] group-hover:text-[#4a5568] group-hover:translate-x-1 flex-shrink-0 transition-all duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),a("button",{type:"button",onClick:c=>{c.stopPropagation(),ie(!0),b("")},className:"w-full flex items-center gap-3 p-3 rounded-lg bg-white/6 hover:bg-white/12 hover:shadow-sm active:bg-white/5 transition-all duration-200 text-left min-h-[52px] cursor-pointer group",style:{touchAction:"manipulation",pointerEvents:"auto"},children:[e("svg",{className:"w-4 h-4 text-[#60758a] group-hover:text-[#4a5568] flex-shrink-0 transition-colors duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),a("div",{className:"flex-1 min-w-0",children:[e("p",{className:"text-sm font-medium text-[#111418] group-hover:text-[#0b1220] transition-colors duration-200",children:"Reset Password"}),e("p",{className:"text-xs text-[#60758a] group-hover:text-[#4a5568] mt-0.5 transition-colors duration-200",children:"Change your account password"})]}),e("svg",{className:"w-4 h-4 text-[#60758a] group-hover:text-[#4a5568] group-hover:translate-x-1 flex-shrink-0 transition-all duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]}),o==="student"&&a("div",{children:[a("h4",{className:"text-sm font-semibold text-[#111418] group-hover:text-[#0b1220] mb-2 flex items-center gap-2 transition-colors duration-200",children:[e("svg",{className:"w-4 h-4 group-hover:text-yellow-600 transition-colors duration-200",fill:"currentColor",viewBox:"0 0 20 20",children:e("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})}),"Account"]}),e("div",{className:"space-y-2",children:a("button",{type:"button",onClick:c=>{c.stopPropagation(),ie(!0),b("")},className:"w-full flex items-center gap-3 p-3 rounded-lg bg-white/6 hover:bg-white/12 hover:shadow-sm active:bg-white/5 transition-all duration-200 text-left min-h-[52px] cursor-pointer group",style:{touchAction:"manipulation",pointerEvents:"auto"},children:[e("svg",{className:"w-4 h-4 text-[#60758a] group-hover:text-[#4a5568] flex-shrink-0 transition-colors duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),a("div",{className:"flex-1 min-w-0",children:[e("p",{className:"text-sm font-medium text-[#111418] group-hover:text-[#0b1220] transition-colors duration-200",children:"Change Password"}),e("p",{className:"text-xs text-[#60758a] group-hover:text-[#4a5568] mt-0.5 transition-colors duration-200",children:"Update your login password"})]}),e("svg",{className:"w-4 h-4 text-[#60758a] group-hover:text-[#4a5568] group-hover:translate-x-1 flex-shrink-0 transition-all duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})]}),a("div",{className:"border-t border-[#e7edf4] pt-3",children:[a("h4",{className:"text-sm font-semibold text-[#111418] group-hover:text-[#0b1220] mb-2 flex items-center gap-2 transition-colors duration-200",children:[e("svg",{className:"w-4 h-4 group-hover:text-yellow-600 transition-colors duration-200",fill:"currentColor",viewBox:"0 0 20 20",children:e("path",{d:"M10 2a6 6 0 00-6 6v3.586l-.707.707A1 1 0 004 14h12a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z"})}),"Notifications"]}),!x&&e("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-3 mb-3",children:e("p",{className:"text-xs text-yellow-700",children:"Browser notifications not supported"})}),H==="denied"&&e("div",{className:"bg-red-50 border border-red-200 rounded-md p-3 mb-3",children:e("p",{className:"text-xs text-red-700",children:"Notifications blocked. Enable in browser settings."})}),W&&H==="granted"&&e("div",{className:"bg-green-50 border border-green-200 rounded-md p-3 mb-3",children:e("p",{className:"text-xs text-green-700",children:"‚úì Notifications enabled successfully!"})}),a("div",{className:"space-y-3",children:[a("div",{className:"flex items-center justify-between p-3 rounded-lg bg-white/6 min-h-[52px]",children:[a("div",{className:"flex-1",children:[e("p",{className:"text-sm font-medium text-[#111418]",children:"Push Notifications"}),e("p",{className:"text-xs text-[#60758a]",children:"Get academic notifications"})]}),e("div",{className:"flex-shrink-0 toggle-touch-area",children:e("button",{type:"button",onClick:c=>{c.preventDefault(),c.stopPropagation(),console.log("Button clicked by user"),q()},disabled:R||!x||H==="denied"||v,className:"toggle-switch ".concat(W?"enabled":"disabled"," ").concat(R||v?"toggle-loading":""," disabled:opacity-50 disabled:cursor-not-allowed"),style:{touchAction:"manipulation",pointerEvents:"auto"},"aria-label":"".concat(W?"Disable":"Enable"," push notifications"),children:R?e("div",{className:"toggle-knob",children:a("svg",{className:"animate-spin h-3 w-3 text-theme-gold-600 mx-auto",fill:"none",viewBox:"0 0 24 24",children:[e("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}):e("div",{className:"toggle-knob ".concat(W?"enabled":"disabled")})})})]}),a("div",{className:"flex items-center justify-between p-3 rounded-lg bg-white/6 min-h-[52px]",children:[a("div",{className:"flex-1",children:[e("p",{className:"text-sm font-medium text-[#111418]",children:"Email Notifications"}),e("p",{className:"text-xs text-[#60758a]",children:"Receive academic updates via email"})]}),e("div",{className:"flex-shrink-0 toggle-touch-area",children:e("button",{type:"button",onClick:c=>{c.stopPropagation(),D()},className:"toggle-switch ".concat(B?"enabled":"disabled"),style:{touchAction:"manipulation",pointerEvents:"auto"},"aria-label":"".concat(B?"Disable":"Enable"," email notifications"),children:e("div",{className:"toggle-knob ".concat(B?"enabled":"disabled")})})})]})]})]}),a("div",{className:"border-t border-[#e7edf4] pt-3",children:[a("h4",{className:"text-sm font-semibold text-[#111418] group-hover:text-[#0b1220] mb-2 flex items-center gap-2 transition-colors duration-200",children:[e("svg",{className:"w-4 h-4 group-hover:text-yellow-600 transition-colors duration-200",fill:"currentColor",viewBox:"0 0 20 20",children:e("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})}),"Help & Support"]}),e("div",{className:"space-y-2",children:a("button",{type:"button",onClick:Et,className:"w-full flex items-center gap-3 p-3 rounded-lg bg-white/6 hover:bg-white/12 hover:shadow-sm active:bg-white/5 transition-all duration-200 text-left min-h-[52px] cursor-pointer group",style:{touchAction:"manipulation",pointerEvents:"auto"},children:[e("svg",{className:"w-4 h-4 text-[#60758a] group-hover:text-[#4a5568] flex-shrink-0 transition-colors duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),e("span",{className:"text-sm font-medium text-[#111418] group-hover:text-[#0b1220] flex-1 transition-colors duration-200",children:"Email Support"}),e("svg",{className:"w-4 h-4 text-[#60758a] group-hover:text-[#4a5568] group-hover:translate-x-1 group-hover:-translate-y-1 flex-shrink-0 transition-all duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})})]}),e("div",{className:"border-t border-[#e7edf4] pt-3 mt-3",children:a("button",{type:"button",onClick:c=>{c.stopPropagation(),St()},className:"w-full flex items-center justify-center gap-2 p-3 rounded-lg bg-red-50 hover:bg-red-100 active:bg-red-200 text-red-600 font-semibold text-sm transition-colors min-h-[48px] cursor-pointer",style:{touchAction:"manipulation",pointerEvents:"auto"},children:[e("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Logout"]})})]}),Fe=a("div",{ref:N,onClick:c=>c.stopPropagation(),onMouseDown:c=>c.stopPropagation(),className:(_?"inner-panel pointer-events-auto":"settings-glass-card no-mobile-backdrop pointer-events-auto")+" rounded-xl shadow-lg overflow-hidden w-full max-w-sm mx-auto flex flex-col group "+(_?"rounded-b-2xl sm:rounded-xl max-w-md":"absolute top-full right-0 mt-2 w-80"),style:{boxShadow:"0 8px 28px rgba(2,6,23,0.06)",background:_?"#ffffff":void 0,maxHeight:_?"calc(100vh - 80px)":"90vh",overflowY:"auto",..._&&{marginTop:"100px",marginLeft:"auto",marginRight:"auto"}},onMouseEnter:()=>{!$&&typeof document<"u"&&document.body.classList.add("settings-hover-active")},onMouseLeave:()=>{!$&&typeof document<"u"&&document.body.classList.remove("settings-hover-active")},children:[e(Ct,{}),e(_t,{}),S&&e("div",{className:"fixed inset-0 z-[70] flex items-center justify-center bg-black/40 backdrop-blur-sm",onClick:c=>{c.currentTarget===c.target&&Q()},children:a("div",{className:"bg-white rounded-2xl p-6 w-full max-w-sm mx-4 shadow-2xl max-h-[90vh] overflow-y-auto",onClick:c=>c.stopPropagation(),children:[e("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Reset Password"}),de&&e("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4",children:e("p",{className:"text-sm text-red-700",children:de})}),a("div",{className:"space-y-4 mb-6",children:[a("div",{children:[e("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Current Password"}),e("input",{type:"password",value:L,onChange:c=>Z(c.target.value),placeholder:"Enter current password",className:"w-full px-4 py-2.5 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-yellow-500 focus:outline-none text-base",autoComplete:"current-password"})]}),a("div",{children:[e("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"New Password"}),e("input",{type:"password",value:d,onChange:c=>w(c.target.value),placeholder:"Enter new password (min. 6 characters)",className:"w-full px-4 py-2.5 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-yellow-500 focus:outline-none text-base",autoComplete:"new-password"})]}),a("div",{children:[e("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Confirm New Password"}),e("input",{type:"password",value:j,onChange:c=>O(c.target.value),placeholder:"Confirm new password",className:"w-full px-4 py-2.5 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-yellow-500 focus:outline-none text-base",autoComplete:"new-password"})]})]}),a("div",{className:"flex gap-3",children:[e("button",{onClick:Q,className:"flex-1 px-4 py-2.5 border-2 border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-semibold text-sm transition-colors",children:"Cancel"}),e("button",{onClick:ae,disabled:be,className:"flex-1 px-4 py-2.5 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 disabled:opacity-60 font-semibold text-sm transition-colors",children:be?"Resetting...":"Reset Password"})]})]})}),V&&e("div",{className:"fixed inset-0 z-[70] flex items-center justify-center bg-black/40 backdrop-blur-sm",onClick:c=>{c.currentTarget===c.target&&Ze()},children:a("div",{className:"bg-white rounded-2xl p-6 w-full max-w-md mx-4 shadow-2xl max-h-[90vh] overflow-y-auto",onClick:c=>c.stopPropagation(),children:[e("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Add Your Signature"}),e("p",{className:"text-sm text-gray-600 mb-5",children:"This signature will be used in generated PDFs"}),a("div",{className:"flex gap-2 mb-5 bg-gray-100 p-1 rounded-lg",children:[e("button",{onClick:()=>ne("draw"),className:"flex-1 py-2.5 px-4 rounded-md font-semibold text-sm transition-all ".concat(ve==="draw"?"bg-white text-gray-900 shadow-md":"text-gray-600 hover:text-gray-900"),children:"‚úçÔ∏è Draw"}),e("button",{onClick:()=>ne("upload"),className:"flex-1 py-2.5 px-4 rounded-md font-semibold text-sm transition-all ".concat(ve==="upload"?"bg-white text-gray-900 shadow-md":"text-gray-600 hover:text-gray-900"),children:"üì§ Upload"})]}),ve==="draw"&&e("div",{className:"mb-5 border-2 border-gray-300 rounded-xl overflow-hidden bg-white",style:{height:"160px"},children:e("canvas",{ref:m,width:400,height:160,onMouseDown:A,onMouseMove:we,onMouseUp:Ce,onMouseLeave:Ce,onTouchStart:A,onTouchMove:we,onTouchEnd:Ce,className:"w-full h-full cursor-crosshair",style:{touchAction:"none",display:"block"}})}),ve==="upload"&&a("div",{className:"mb-5",children:[e("input",{ref:f,type:"file",accept:"image/jpeg,image/jpg,image/png",onChange:Te,className:"hidden",id:"signature-upload"}),pe?e("div",{className:"border-2 border-gray-300 rounded-xl overflow-hidden bg-white flex items-center justify-center",style:{height:"160px"},children:e("img",{src:pe,alt:"Uploaded",className:"max-w-full max-h-full object-contain"})}):a("label",{htmlFor:"signature-upload",className:"flex flex-col items-center justify-center border-2 border-dashed border-gray-300 rounded-xl p-8 cursor-pointer hover:border-yellow-500 hover:bg-yellow-50 transition-all",style:{height:"160px"},children:[e("svg",{className:"w-12 h-12 text-gray-400 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),e("p",{className:"text-sm font-semibold text-gray-700 mb-1",children:"Click to upload signature"}),e("p",{className:"text-xs text-gray-500",children:"JPEG or PNG (max 2MB)"})]})]}),a("div",{className:"flex gap-2",children:[e("button",{onClick:Re,className:"flex-1 px-4 py-2.5 border-2 border-gray-400 text-gray-700 rounded-lg hover:bg-gray-100 font-semibold text-sm transition-colors",children:"Clear"}),e("button",{onClick:Ze,className:"flex-1 px-4 py-2.5 border-2 border-gray-400 text-gray-700 rounded-lg hover:bg-gray-100 font-semibold text-sm transition-colors",children:"Cancel"}),e("button",{onClick:Me,className:"flex-1 px-4 py-2.5 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 font-semibold text-sm transition-colors shadow-md",children:"Save"})]})]})})]});if(!$)return Fe;const Lt=e("div",{className:"fixed inset-0 z-50 flex flex-col bg-black/60 backdrop-blur-sm",onClick:c=>{c.currentTarget===c.target&&r()},children:e("div",{className:"w-full flex-1 overflow-y-auto",children:Fe})});return _?Ue.createPortal(Lt,document.body):Fe}function Nt({children:t,actions:r=[],onSwipe:s}){const[o,n]=i.useState(0),[l,p]=i.useState(!1),[g,M]=i.useState(!1),h=i.useRef(0),N=i.useRef(0),m=i.useRef(0),f=i.useRef(null),k=50,_=200,re=200;i.useEffect(()=>{const x=H=>{f.current&&!f.current.contains(H.target)&&g&&B()};return document.addEventListener("mousedown",x),document.addEventListener("touchstart",x),()=>{document.removeEventListener("mousedown",x),document.removeEventListener("touchstart",x)}},[g]);const $=x=>{h.current=x.touches[0].clientX,N.current=x.touches[0].clientY,p(!0)},W=x=>{if(!l)return;const H=x.touches[0].clientX,se=x.touches[0].clientY,R=H-h.current,G=se-N.current,V=10;if(!(Math.abs(R)>V&&Math.abs(R)>Math.abs(G)*1.5))return;const ve=R>0,ne=R<0,pe=r.some(E=>E.direction==="right"),u=r.some(E=>E.direction!=="right");if(ve&&!pe||ne&&!u)return;let y=Math.max(Math.min(R,_),-_);m.current=y,n(y)},T=()=>{if(p(!1),Math.abs(m.current)>k){const x=m.current>0,H=r.filter(G=>x?G.direction==="right":G.direction!=="right");if(x&&H.some(G=>G.autoTrigger)){const G=H.find(V=>V.autoTrigger);if(G){B(),G.onClick&&G.onClick();return}}const se=Math.min(H.length*re,_),R=x?se:-se;n(R),M(!0),s&&s()}else B()},B=()=>{n(0),M(!1),m.current=0},J=x=>{B(),x.onClick&&x.onClick()};return a("div",{ref:f,className:"relative overflow-hidden rounded-xl shadow-sm border border-gray-200",style:{touchAction:"pan-y",transform:"translateZ(0)",willChange:l?"transform":"auto"},children:[e("div",{className:"absolute inset-y-0 right-0 flex flex-col items-center justify-center gap-3 py-3 z-0",style:{width:"200px"},children:r.filter(x=>x.direction!=="right").map((x,H)=>a("button",{onClick:()=>J(x),className:"flex items-center justify-center gap-2 px-6 py-3 font-semibold transition-all duration-200 text-sm rounded-lg shadow-md hover:shadow-lg active:scale-95 ".concat(x.className||"border-gray-200 text-gray-600 bg-white"),style:{minWidth:"140px",minHeight:"48px"},title:x.label,children:[x.icon,e("span",{children:x.label})]},H))}),e("div",{className:"absolute inset-y-0 left-0 flex flex-col items-center justify-center gap-3 py-3 z-0",style:{width:"200px"},children:r.filter(x=>x.direction==="right").map((x,H)=>a("button",{onClick:()=>J(x),className:"flex items-center justify-center gap-2 px-6 py-3 font-semibold transition-all duration-200 text-sm rounded-lg shadow-md hover:shadow-lg active:scale-95 ".concat(x.className||"border-gray-200 text-gray-600 bg-white"),style:{minWidth:"140px",minHeight:"48px"},title:x.label,children:[x.icon,e("span",{children:x.label})]},H))}),e("div",{className:"relative z-10 bg-white rounded-xl",style:{transform:"translate3d(".concat(o,"px, 0, 0)"),transition:l?"none":"transform 0.3s cubic-bezier(0.4, 0, 0.2, 1)",willChange:l?"transform":"auto",boxShadow:g?"0 4px 6px -1px rgba(0, 0, 0, 0.1)":"none"},onTouchStart:$,onTouchMove:W,onTouchEnd:T,children:t})]})}function Rr(t={}){i.useEffect(()=>{if(!("serviceWorker"in navigator)){console.warn("Service Workers not supported");return}const r=s=>{if(!s.data)return;const{type:o,data:n}=s.data;o==="NOTIFICATION_RECEIVED"&&t[n==null?void 0:n.notificationType]&&(console.log("üì≤ Push notification received: ".concat(n.notificationType)),console.log("   Triggering refresh handler..."),t[n.notificationType](n))};return navigator.serviceWorker.addEventListener("message",r),()=>{navigator.serviceWorker.removeEventListener("message",r)}},[t])}function fa(t){i.useEffect(()=>{const r=()=>{document.hidden||(console.log("üì± Page came into focus, refreshing data..."),t==null||t())};return document.addEventListener("visibilitychange",r),()=>{document.removeEventListener("visibilitychange",r)}},[t])}const Ar=i.memo(({notification:t,onMarkRead:r})=>{var s;return e("div",{className:"border rounded-xl p-4 sm:p-5 transition-all ".concat(t.read?"bg-white border-gray-200":"bg-blue-50 border-blue-200"),children:a("div",{className:"flex items-start justify-between gap-3",children:[a("div",{className:"flex-1 min-w-0",children:[a("div",{className:"flex items-center gap-2 mb-1",children:[e("span",{className:"text-xs font-bold px-2 py-1 rounded-full ".concat(t.read?"bg-gray-100 text-gray-700":"bg-blue-100 text-blue-700"),children:((s=t.type)==null?void 0:s.replace(/_/g," "))||"notification"}),!t.read&&e("span",{className:"text-[11px] font-semibold text-blue-700",children:"NEW"})]}),e("h3",{className:"text-sm sm:text-base font-bold text-gray-900 break-words",children:t.title}),e("p",{className:"text-xs sm:text-sm text-gray-700 mt-1 break-words",children:t.body}),e("p",{className:"text-[11px] text-gray-500 mt-2",children:t.createdAt?new Date(t.createdAt).toLocaleString():"Just now"})]}),!t.read&&e("button",{onClick:()=>r(t._id),className:"text-xs font-semibold text-green-700 bg-green-50 border border-green-100 px-3 py-1.5 rounded-lg hover:bg-green-100",children:"Mark read"})]})})}),Pr=i.memo(({request:t,onApprove:r,processing:s})=>{var n,l,p,g;const o=i.useMemo(()=>[{label:"Record",icon:e(_e,{className:"w-5 h-5"}),onClick:()=>r(t),className:"bg-green-600 hover:bg-green-700 text-white"}],[r,t]);return e(Nt,{actions:o,children:a("div",{className:"bg-gradient-to-br from-white to-amber-50 border-2 border-amber-200 rounded-lg p-3 hover:border-amber-400 transition-all",children:[a("div",{className:"flex items-start justify-between mb-2",children:[a("div",{children:[e("p",{className:"font-semibold text-gray-900",children:(n=t.data)==null?void 0:n.studentName}),e("p",{className:"text-xs text-gray-600",children:(l=t.data)==null?void 0:l.regNumber})]}),e("span",{className:"text-xs font-bold px-2 py-1 rounded-full bg-amber-100 text-amber-800",children:"Late"})]}),a("p",{className:"text-sm text-gray-700 mb-2",children:[e("strong",{children:"Reason:"})," ",(p=t.data)==null?void 0:p.reason]}),a("p",{className:"text-xs text-gray-600 mb-3",children:["Expected: ",new Date((g=t.data)==null?void 0:g.expectedArrivalTime).toLocaleString()]}),e("p",{className:"text-xs text-green-600 mb-3 font-semibold",children:"üëâ Student will confirm arrival in their dashboard"}),e("button",{onClick:()=>r(t),disabled:s===t._id,className:"hidden sm:flex w-full items-center justify-center gap-2 px-3 py-2 bg-green-600 hover:bg-green-700 disabled:opacity-50 text-white text-sm font-semibold rounded-lg transition-colors",children:s===t._id?a(fe,{children:[a("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[e("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Recording..."]}):a(fe,{children:[e(_e,{className:"w-4 h-4"}),"Record"]})})]})})}),Dr=i.memo(({request:t,onApprove:r,onReject:s,processing:o})=>{var l,p;const n=i.useMemo(()=>[{label:"Reject",icon:e(ct,{className:"w-5 h-5"}),onClick:()=>s(t),className:"bg-red-600 hover:bg-red-700 text-white"},{label:"Accept",icon:e(Ge,{className:"w-5 h-5"}),onClick:()=>r(t),className:"bg-green-600 hover:bg-green-700 text-white"}],[r,s,t]);return e(Nt,{actions:n,children:a("div",{className:"bg-gradient-to-br from-white to-gray-50 border-2 border-gray-200 rounded-xl p-4 sm:p-5 hover:border-theme-gold/30 transition-all duration-200",children:[e("div",{className:"mb-3 flex items-center justify-between",children:e("span",{className:"text-xs font-bold px-2 py-1 rounded-full ".concat(t.type==="staff_account_approval"?"bg-blue-100 text-blue-700":"bg-orange-100 text-orange-700"),children:t.type==="staff_account_approval"?"üë§ Staff Account":"üìã Leave Request"})}),t.type==="staff_account_approval"?a("div",{className:"mb-4",children:[a("div",{className:"flex items-start justify-between mb-3",children:[a("div",{className:"flex-1",children:[e("h3",{className:"text-base sm:text-lg font-bold text-gray-900 mb-1",children:t.data.staffName}),e("p",{className:"text-sm text-gray-600 break-all",children:t.data.staffEmail}),t.data.phoneNumber&&a("p",{className:"text-sm text-gray-600 mt-1",children:["üì± ",t.data.phoneNumber]})]}),e("div",{className:"w-10 h-10 rounded-full bg-theme-gold-gradient flex items-center justify-center flex-shrink-0 ml-3",children:e("span",{className:"text-white font-bold text-sm",children:(l=t.data.staffName)==null?void 0:l.charAt(0).toUpperCase()})})]}),a("div",{className:"grid grid-cols-3 gap-2 sm:gap-3",children:[a("div",{className:"bg-white rounded-lg p-2 sm:p-3 border border-gray-200",children:[e("p",{className:"text-xs text-gray-500 mb-1",children:"Department"}),e("p",{className:"text-xs sm:text-sm font-bold text-gray-900",children:t.data.department})]}),a("div",{className:"bg-white rounded-lg p-2 sm:p-3 border border-gray-200",children:[e("p",{className:"text-xs text-gray-500 mb-1",children:"Year"}),e("p",{className:"text-xs sm:text-sm font-bold text-gray-900",children:t.data.year})]}),a("div",{className:"bg-white rounded-lg p-2 sm:p-3 border border-gray-200",children:[e("p",{className:"text-xs text-gray-500 mb-1",children:"Section"}),e("p",{className:"text-xs sm:text-sm font-bold text-gray-900",children:t.data.section})]})]})]}):a("div",{className:"mb-4",children:[a("div",{className:"flex items-start justify-between mb-4",children:[a("div",{className:"flex-1",children:[e("h3",{className:"text-base sm:text-lg font-bold text-gray-900 mb-2",children:t.data.studentName||"Unknown Student"}),a("div",{className:"space-y-1 text-sm",children:[a("p",{className:"text-gray-600",children:[e("span",{className:"text-gray-500",children:"Reg:"})," ",t.data.regNumber||"‚Äî"]}),a("p",{className:"text-gray-600 capitalize",children:[e("span",{className:"text-gray-500",children:"Leave Type:"})," ",t.data.type||"‚Äî"]})]})]}),e("div",{className:"w-12 h-12 rounded-full bg-orange-gradient flex items-center justify-center flex-shrink-0 ml-3",children:e("span",{className:"text-white font-bold text-lg",children:(p=t.data.studentName)==null?void 0:p.charAt(0).toUpperCase()})})]}),a("div",{className:"grid grid-cols-2 gap-2 sm:gap-3 mb-3",children:[a("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[e("p",{className:"text-xs text-gray-500 mb-1",children:"Year"}),e("p",{className:"text-sm font-bold text-gray-900",children:t.data.year||"‚Äî"})]}),a("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[e("p",{className:"text-xs text-gray-500 mb-1",children:"Section"}),e("p",{className:"text-sm font-bold text-gray-900",children:t.data.section||"‚Äî"})]}),a("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[e("p",{className:"text-xs text-gray-500 mb-1",children:"From"}),e("p",{className:"text-sm font-bold text-gray-900",children:t.data.startDate?new Date(t.data.startDate).toLocaleDateString("en-IN",{month:"short",day:"numeric"}):"‚Äî"})]}),a("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[e("p",{className:"text-xs text-gray-500 mb-1",children:"To"}),e("p",{className:"text-sm font-bold text-gray-900",children:t.data.endDate?new Date(t.data.endDate).toLocaleDateString("en-IN",{month:"short",day:"numeric"}):"‚Äî"})]})]}),t.data.reason&&a("div",{className:"bg-white rounded-lg p-3 border border-gray-200 mb-3",children:[e("p",{className:"text-xs text-gray-500 mb-1",children:"Reason"}),e("p",{className:"text-sm text-gray-700 line-clamp-2",children:t.data.reason})]})]}),a("p",{className:"text-xs text-gray-500 mb-3",children:["Requested ",new Date(t.createdAt).toLocaleDateString()," at ",new Date(t.createdAt).toLocaleTimeString()]}),a("div",{className:"hidden sm:flex gap-2 sm:gap-3",children:[a("button",{onClick:()=>r(t),disabled:o===t._id,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white rounded-lg font-semibold transition-all duration-200 text-sm sm:text-base",children:[e(Ge,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e("span",{children:o===t._id?"Processing...":"Accept"})]}),a("button",{onClick:()=>s(t),disabled:o===t._id,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 bg-red-600 hover:bg-red-700 disabled:bg-gray-400 text-white rounded-lg font-semibold transition-all duration-200 text-sm sm:text-base",children:[e(ct,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e("span",{children:o===t._id?"Processing...":"Reject"})]})]})]})})});function Tr({isOpen:t,onClose:r,setUnreadCount:s}){const[o,n]=i.useState([]),[l,p]=i.useState(!0),[g,M]=i.useState(null),[h,N]=i.useState(""),[m,f]=i.useState(null),[k,_]=i.useState({open:!1,request:null,reason:""});i.useEffect(()=>{var u;if(t){const y=JSON.parse(localStorage.getItem("auth")||"{}"),E=(y==null?void 0:y.role)||((u=y.user)==null?void 0:u.role)||"";N(E),p(!0),B({force:!1,immediate:!0})}},[t]),i.useEffect(()=>{const u=()=>{t&&B({force:!0,immediate:!0})};return window.addEventListener("authStateChanged",u),()=>window.removeEventListener("authStateChanged",u)},[t]),i.useEffect(()=>{if(!t)return;const u=()=>{re.current&&Date.now()-re.current<$||B({force:!0})};return window.addEventListener("notificationsUpdated",u),window.addEventListener("marksheetsUpdated",u),()=>{window.removeEventListener("notificationsUpdated",u),window.removeEventListener("marksheetsUpdated",u)}},[t]),Rr(t?{late_arrival:()=>{console.log("üîî Late arrival notification triggered refresh in NotificationRequests"),J()},leave_request:()=>{console.log("üîî Leave request notification triggered refresh in NotificationRequests"),J()},staff_approval:()=>{console.log("üîî Staff approval notification triggered refresh in NotificationRequests"),J()},marksheet_dispatch:()=>{console.log("üîî Marksheet dispatch notification triggered refresh in NotificationRequests"),J()}}:{});const re=i.useRef(0),$=2e3,W=i.useRef(null),T=i.useRef(!1),B=(u={})=>{const{force:y=!1,immediate:E=!1}=u;return E?(W.current&&(clearTimeout(W.current),W.current=null),T.current?new Promise(S=>{W.current=setTimeout(async()=>{try{await J({force:y})}catch(ie){}try{window.refreshNotificationCount&&window.refreshNotificationCount()}catch(ie){}S()},200)}):(T.current=!0,J({force:y}).finally(()=>{T.current=!1}).then(S=>{try{window.refreshNotificationCount&&window.refreshNotificationCount()}catch(ie){}return S}))):(W.current&&clearTimeout(W.current),W.current=setTimeout(async()=>{if(!T.current){T.current=!0;try{await J({force:y})}catch(S){}try{window.refreshNotificationCount&&window.refreshNotificationCount()}catch(S){}T.current=!1}},150),Promise.resolve())},J=async(u={})=>{var E,S,ie,L,Z,d,w,j,O,de;const{force:y=!1}=u;try{p(!0);const b=JSON.parse(localStorage.getItem("auth")||"{}"),be=(b==null?void 0:b.role)||((E=b.user)==null?void 0:E.role),le=(b==null?void 0:b.id)||((S=b.user)==null?void 0:S.id);if(be==="hod"){const v=le;if(!v){n([]),p(!1);return}const F="/api/staff-approval?action=pending&hodId=".concat(v),P=(b==null?void 0:b.department)||((ie=b.user)==null?void 0:ie.department),q="/api/leaves?department=".concat(P,"&type=leave");try{const D=y?{cache:!1,dedupe:!1}:{},[z,ae]=await Promise.all([U.get(F,D),U.get(q,D)]),Q=[];if(z.success&&z.requests){const me=(z.requests||[]).map(A=>({_id:A.id,type:"staff_account_approval",createdAt:A.createdAt,data:{requestId:A.id,staffName:A.name,staffEmail:A.email,phoneNumber:A.phoneNumber,department:A.department,year:A.year,section:A.section,status:"pending"}}));Q.push(...me)}if(ae.success&&ae.requests){const me=(ae.requests||[]).filter(A=>A.status==="requested").map(A=>{var we,Ce,Te,Re,Me;return{_id:A._id,type:"leave_request",createdAt:A.createdAt,data:{requestId:A._id,studentName:(we=A.studentDetails)==null?void 0:we.name,regNumber:(Ce=A.studentDetails)==null?void 0:Ce.regNumber,department:(Te=A.studentDetails)==null?void 0:Te.department,year:(Re=A.studentDetails)==null?void 0:Re.year,section:(Me=A.studentDetails)==null?void 0:Me.section,reason:A.reason,startDate:A.startDate,endDate:A.endDate,type:A.type,status:"pending"}}});Q.push(...me)}n(Q),s&&s(Q.length)}catch(D){console.error("[NotificationRequests] Error fetching requests:",D),n([])}}else if(be==="staff"){const v=await U.get("/api/notifications?userEmail=".concat((b==null?void 0:b.email)||((L=b.user)==null?void 0:L.email)),y?{cache:!1,dedupe:!1}:{});let F=[];if(v.success){const P=v.notifications.find(q=>{var D,z;return q.type==="staff_account_approval"&&((D=q.data)==null?void 0:D.staffEmail)===((b==null?void 0:b.email)||((z=b.user)==null?void 0:z.email))});P&&f({status:((Z=P.data)==null?void 0:Z.status)||"pending",processedAt:(d=P.data)==null?void 0:d.processedAt,department:(w=P.data)==null?void 0:w.department,year:(j=P.data)==null?void 0:j.year,section:(O=P.data)==null?void 0:O.section,createdAt:P.createdAt})}if(b!=null&&b.year&&(b!=null&&b.section)&&(b!=null&&b.department))try{const P=await U.get("/api/leaves?department=".concat(b.department,"&type=late&status=requested"),y?{cache:!1,dedupe:!1}:{});if(P.success&&P.requests){const q=(P.requests||[]).filter(D=>{var z,ae;return((z=D.studentDetails)==null?void 0:z.year)===b.year&&((ae=D.studentDetails)==null?void 0:ae.section)===b.section}).map(D=>{var z,ae,Q,me,A;return{_id:D._id,type:"late_arrival",createdAt:D.createdAt,data:{requestId:D._id,studentName:(z=D.studentDetails)==null?void 0:z.name,regNumber:(ae=D.studentDetails)==null?void 0:ae.regNumber,department:(Q=D.studentDetails)==null?void 0:Q.department,year:(me=D.studentDetails)==null?void 0:me.year,section:(A=D.studentDetails)==null?void 0:A.section,reason:D.reason,expectedArrivalTime:D.expectedArrivalTime,type:D.type,status:"pending"}}});F=[...F,...q]}}catch(P){console.error("[NotificationRequests] Error fetching late requests:",P)}n(F)}else if(be==="admin"){const v=(b==null?void 0:b.email)||((de=b.user)==null?void 0:de.email);if(!v)n([]);else{const F=await U.get("/api/notifications?userEmail=".concat(encodeURIComponent(v)),y?{cache:!1,dedupe:!1}:{});if(F.success&&Array.isArray(F.notifications)){const P=F.notifications.map(q=>({_id:q._id,type:q.type||"system",title:q.title||"System notification",body:q.body||q.message||"No details provided",createdAt:q.createdAt,read:!!q.read,data:q.data||{}}));n(P),s&&s(P.filter(q=>!q.read).length)}else n([])}}}catch(b){console.error("Error fetching requests:",b)}finally{p(!1)}},x=async u=>{var y,E;if(u.type==="late_arrival"){M(u._id);try{const S=JSON.parse(localStorage.getItem("auth")||"{}"),ie=(S==null?void 0:S.id)||((y=S.user)==null?void 0:y.id);try{await U.patch("/api/leaves?id=".concat(u.data.requestId,"&action=acknowledge"),{staffId:ie}),n(L=>{const Z=L.filter(d=>d._id!==u._id);return s&&s(Z.length),Z}),re.current=Date.now();try{Y(()=>import("./notificationEvents-12cfbdaf.js"),[]).then(L=>L.notifyNotificationsUpdatedImmediate&&L.notifyNotificationsUpdatedImmediate())}catch(L){}try{window.dispatchEvent(new Event("notificationsUpdated"))}catch(L){}try{window.refreshNotificationCount&&window.refreshNotificationCount()}catch(L){}}catch(L){console.error("Error recording late arrival:",L)}}catch(S){console.error("Error recording late arrival:",S)}finally{M(null)}return}M(u._id);try{const S=JSON.parse(localStorage.getItem("auth")||"{}"),ie=(S==null?void 0:S.id)||((E=S.user)==null?void 0:E.id);try{if(u.type==="staff_account_approval")await U.patch("/api/staff-approval",{requestId:u.data.requestId,action:"approve",hodId:ie},{timeout:2e4,retry:1,dispatch:!1});else if(u.type==="leave_request")await U.patch("/api/leaves?id=".concat(u.data.requestId,"&action=approve"),{hodId:ie},{timeout:6e4,retry:1,dispatch:!1});else{M(null);return}const L=u._id;n(Z=>{const d=Z.filter(w=>w._id!==L);return s&&s(d.length),d}),re.current=Date.now();try{Y(()=>import("./notificationEvents-12cfbdaf.js"),[]).then(Z=>Z.notifyNotificationsUpdatedImmediate&&Z.notifyNotificationsUpdatedImmediate())}catch(Z){}try{typeof window.dispatchEvent=="function"&&window.dispatchEvent(new Event("notificationsUpdated"))}catch(Z){}try{window.refreshNotificationCount&&window.refreshNotificationCount()}catch(Z){}}catch(L){if(console.error("Error approving request:",L),L&&(L.name==="AbortError"||L.message&&L.message.includes("aborted")))try{await J({force:!0})}catch(Z){}}}catch(S){console.error("Error approving request:",S)}finally{M(null)}},H=async u=>{_({open:!0,request:u,reason:""})},se=()=>{_({open:!1,request:null,reason:""}),M(null)},R=async()=>{var y;if(!k||!k.request)return;const u=k.request;M(u._id);try{const E=JSON.parse(localStorage.getItem("auth")||"{}"),S=(E==null?void 0:E.id)||((y=E.user)==null?void 0:y.id),ie=(k.reason||"").trim();try{u.type==="staff_account_approval"?await U.patch("/api/staff-approval",{requestId:u.data.requestId,action:"reject",hodId:S,rejectionReason:ie},{dispatch:!1}):u.type==="leave_request"&&await U.patch("/api/leaves?id=".concat(u.data.requestId,"&action=reject"),{hodId:S,reason:ie},{dispatch:!1}),n(L=>{const Z=L.filter(d=>d._id!==u._id);return s&&s(Z.length),Z}),re.current=Date.now();try{Y(()=>import("./notificationEvents-12cfbdaf.js"),[]).then(L=>L.notifyNotificationsUpdatedImmediate&&L.notifyNotificationsUpdatedImmediate())}catch(L){}try{window.dispatchEvent(new Event("notificationsUpdated"))}catch(L){}try{window.refreshNotificationCount&&window.refreshNotificationCount()}catch(L){}}catch(L){console.error("Error rejecting request:",L)}}catch(E){console.error("Error rejecting request:",E)}finally{se()}},G=i.useCallback(async u=>{try{await U.patch("/api/notifications/".concat(u,"/read")),n(y=>{const E=y.map(S=>S._id===u?{...S,read:!0}:S);return s&&s(E.filter(S=>!S.read).length),E})}catch(y){console.error("Error marking notification as read:",y)}},[s]),V=i.useCallback(async()=>{try{const u=o.filter(y=>!y.read);await Promise.all(u.map(y=>U.patch("/api/notifications/".concat(y._id,"/read")))),n(y=>y.map(E=>({...E,read:!0}))),s&&s(0)}catch(u){console.error("Error marking all notifications as read:",u)}},[o,s]),X=i.useCallback(x,[x]),ve=i.useCallback(H,[H]);if(i.useCallback(R,[R]),!t)return null;if(h==="admin"){const u=o.filter(E=>!E.read).length,y=e("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",onClick:E=>{E.target===E.currentTarget&&r()},children:a("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",onClick:E=>E.stopPropagation(),children:[a("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-theme-gold/10 to-theme-gold/5",children:[a("div",{className:"flex items-center gap-3",children:[e("div",{className:"w-10 h-10 rounded-full bg-theme-gold-gradient flex items-center justify-center",children:e(Je,{className:"w-5 h-5 text-white"})}),a("div",{children:[e("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:"Notifications"}),e("p",{className:"text-xs sm:text-sm text-gray-600",children:"System updates for admin"})]})]}),a("div",{className:"flex items-center gap-2",children:[u>0&&e("button",{onClick:V,className:"text-xs sm:text-sm font-semibold text-blue-700 bg-blue-50 border border-blue-100 px-3 py-1.5 rounded-lg hover:bg-blue-100",children:"Mark all read"}),e("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"Close",children:e(Be,{className:"w-5 h-5 text-gray-500"})})]})]}),e("div",{className:"flex-1 overflow-y-auto p-4 sm:p-6",children:l?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-theme-gold"})}):o.length===0?a("div",{className:"text-center py-12",children:[e("div",{className:"w-16 h-16 rounded-full bg-gray-100 mx-auto mb-4 flex items-center justify-center",children:e(_e,{className:"w-8 h-8 text-gray-400"})}),e("p",{className:"text-gray-600 font-medium",children:"No notifications"}),e("p",{className:"text-sm text-gray-500 mt-1",children:"Everything is up to date"})]}):e("div",{className:"space-y-3",children:o.map(E=>e(Ar,{notification:E,onMarkRead:G},E._id))})})]})});return Ue.createPortal(y,document.body)}if(h==="staff"){const u=e("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",onClick:y=>{y.target===y.currentTarget&&r()},children:a("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",onClick:y=>y.stopPropagation(),children:[a("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-theme-gold/10 to-theme-gold/5",children:[a("div",{className:"flex items-center gap-3",children:[e("div",{className:"w-10 h-10 rounded-full bg-theme-gold-gradient flex items-center justify-center",children:e(qe,{className:"w-5 h-5 text-white"})}),a("div",{children:[e("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:"Notifications"}),e("p",{className:"text-xs sm:text-sm text-gray-600",children:"Your account status & late arrivals"})]})]}),e("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"Close",children:e(Be,{className:"w-5 h-5 text-gray-500"})})]}),e("div",{className:"flex-1 overflow-y-auto p-4 sm:p-6",children:l?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-theme-gold"})}):a("div",{className:"space-y-4",children:[m&&a(fe,{children:[e("h3",{className:"text-sm font-bold text-gray-700 mb-3",children:"Account Status"}),a("div",{className:"rounded-xl p-5 border-2 ".concat(m.status==="approved"?"bg-green-50 border-green-300":m.status==="rejected"?"bg-red-50 border-red-300":"bg-blue-50 border-blue-300"),children:[a("div",{className:"flex items-center gap-3 mb-3",children:[m.status==="approved"?e(_e,{className:"w-8 h-8 text-green-600"}):m.status==="rejected"?e(mr,{className:"w-8 h-8 text-red-600"}):e(qe,{className:"w-8 h-8 text-blue-600"}),a("div",{children:[e("h3",{className:"text-lg font-bold text-gray-900",children:m.status==="approved"?"Account Approved":m.status==="rejected"?"Account Rejected":"Pending Approval"}),e("p",{className:"text-sm text-gray-600",children:m.status==="approved"?"Your account has been approved by HOD":m.status==="rejected"?"Your registration was not approved":"Waiting for HOD approval"})]})]}),a("div",{className:"grid grid-cols-3 gap-2 mt-4",children:[a("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[e("p",{className:"text-xs text-gray-500 mb-1",children:"Department"}),e("p",{className:"text-sm font-bold text-gray-900",children:m.department})]}),a("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[e("p",{className:"text-xs text-gray-500 mb-1",children:"Year"}),e("p",{className:"text-sm font-bold text-gray-900",children:m.year})]}),a("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[e("p",{className:"text-xs text-gray-500 mb-1",children:"Section"}),e("p",{className:"text-sm font-bold text-gray-900",children:m.section})]})]}),a("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[a("p",{className:"text-xs text-gray-600",children:["Requested: ",new Date(m.createdAt).toLocaleDateString()," at"," ",new Date(m.createdAt).toLocaleTimeString()]}),m.processedAt&&a("p",{className:"text-xs text-gray-600 mt-1",children:[m.status==="approved"?"Approved":"Rejected",": ",new Date(m.processedAt).toLocaleDateString()," at"," ",new Date(m.processedAt).toLocaleTimeString()]})]})]}),m.status==="pending"&&e("div",{className:"bg-blue-100 border border-blue-300 rounded-lg p-4",children:e("p",{className:"text-sm text-blue-800",children:"Your registration is under review. You will be notified once the HOD processes your request."})}),m.status==="rejected"&&e("div",{className:"bg-red-100 border border-red-300 rounded-lg p-4",children:e("p",{className:"text-sm text-red-800",children:"Please contact your HOD or administrator for more information."})})]}),o.length>0&&e(fe,{children:a("div",{className:m?"mt-6 pt-4 border-t border-gray-200":"",children:[a("h3",{className:"text-sm font-bold text-gray-700 mb-3",children:["Late Arrivals (",o.length,")"]}),e("div",{className:"space-y-3",children:o.map(y=>e(Pr,{request:y,onApprove:X,processing:g},y._id))})]})}),!m&&o.length===0&&a("div",{className:"text-center py-12",children:[e("div",{className:"w-16 h-16 rounded-full bg-gray-100 mx-auto mb-4 flex items-center justify-center",children:e(_e,{className:"w-8 h-8 text-gray-400"})}),e("p",{className:"text-gray-600 font-medium",children:"All set!"}),e("p",{className:"text-sm text-gray-500 mt-1",children:"No pending notifications"})]})]})})]})});return Ue.createPortal(u,document.body)}const ne=e("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",onClick:u=>{u.target===u.currentTarget&&r()},children:a("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",onClick:u=>u.stopPropagation(),children:[a("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-theme-gold/10 to-theme-gold/5",children:[a("div",{className:"flex items-center gap-3",children:[e("div",{className:"w-10 h-10 rounded-full bg-theme-gold-gradient flex items-center justify-center",children:e(qe,{className:"w-5 h-5 text-white"})}),a("div",{children:[e("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:"Requests"}),a("p",{className:"text-xs sm:text-sm text-gray-600",children:["Staff signups & leave/late - ",o.length," pending ",o.length===1?"request":"requests"]})]})]}),e("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"Close",children:e(Be,{className:"w-5 h-5 text-gray-500"})})]}),e("div",{className:"flex-1 overflow-y-auto p-4 sm:p-6",children:l?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-theme-gold"})}):o.length===0?a("div",{className:"text-center py-12",children:[e("div",{className:"w-16 h-16 rounded-full bg-gray-100 mx-auto mb-4 flex items-center justify-center",children:e(Ge,{className:"w-8 h-8 text-gray-400"})}),e("p",{className:"text-gray-600 font-medium",children:"No pending requests"}),e("p",{className:"text-sm text-gray-500 mt-1",children:"All requests have been processed"})]}):e("div",{className:"space-y-4",children:o.map(u=>e(Dr,{request:u,onApprove:X,onReject:ve,processing:g},u._id))})})]})}),pe=k&&k.open?e("div",{className:"fixed inset-0 z-[110] flex items-center justify-center bg-black/60 p-4",onClick:u=>{u.target===u.currentTarget&&se()},children:a("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-lg p-4 sm:p-6",onClick:u=>u.stopPropagation(),children:[e("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"Enter rejection reason (optional)"}),e("p",{className:"text-sm text-gray-600 mb-3",children:"This will be sent to the student/parent as a plain text message."}),e("textarea",{value:k.reason,onChange:u=>_(y=>({...y,reason:u.target.value})),rows:4,placeholder:"Reason for rejection (optional)",className:"w-full rounded-lg border border-gray-200 px-3 py-2 focus:border-blue-500 focus:outline-none mb-4"}),a("div",{className:"flex justify-end gap-3",children:[e("button",{onClick:se,className:"px-4 py-2 rounded-lg bg-gray-100 hover:bg-gray-200 text-sm font-semibold",children:"Cancel"}),e("button",{onClick:R,disabled:g===(k.request&&k.request._id),className:"px-4 py-2 rounded-lg bg-red-600 hover:bg-red-700 text-white text-sm font-semibold disabled:opacity-50",children:g===(k.request&&k.request._id)?"Processing‚Ä¶":"Reject"})]})]})}):null;return Ue.createPortal(a(fe,{children:[ne,pe]}),document.body)}function Mr({src:t,alt:r="",className:s="",sizes:o="100vw",widths:n=null,lazy:l=!0}){if(!t)return null;const p=t.lastIndexOf("."),g=p===-1?t:t.slice(0,p),M=m=>Array.isArray(n)&&n.length>0?n.map(f=>"".concat(g,"-").concat(f,".").concat(m," ").concat(f,"w")).join(", "):"".concat(g,".").concat(m),h=M("avif"),N=M("webp");return a("picture",{className:s,children:[e("source",{type:"image/avif",srcSet:h,sizes:o}),e("source",{type:"image/webp",srcSet:N,sizes:o}),e("img",{src:t,alt:r,loading:l?"lazy":"eager",decoding:"async",style:{width:"100%",height:"100%",objectFit:"contain"}})]})}function jr(){const t=Xe(),r=bt(),s=["/login","/signup"].includes(t.pathname),[o,n]=i.useState(!1),[l,p]=i.useState(""),[g,M]=i.useState(""),[h,N]=i.useState(""),[m,f]=i.useState(!1),[k,_]=i.useState(!1),[re,$]=i.useState(!1),[W,T]=i.useState(0),[B,J]=i.useState([]),[x,H]=i.useState(!1),[se,R]=i.useState(!1),[G,V]=i.useState("unknown"),[X,ve]=i.useState(()=>typeof window>"u"?!1:window.matchMedia("(max-width: 1023px)").matches),ne=d=>t.pathname===d?"text-[#000000] text-sm font-bold leading-normal":"text-[#111418] text-sm font-medium leading-normal hover:text-[#000000] hover:font-bold transition-all duration-200",pe=i.useRef(null),u=i.useRef(null),y=i.useRef(null);i.useEffect(()=>{E();const d=()=>{u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{ve(window.matchMedia("(max-width: 1023px)").matches)},120)};d(),window.addEventListener("resize",d),window.addEventListener("orientationchange",d);const w=()=>{E();try{f(!1),_(!1)}catch(O){}};window.addEventListener("authStateChanged",w);const j=()=>{try{if(!(o&&l&&g))return;y.current&&clearTimeout(y.current),y.current=setTimeout(()=>{S(l,g,!0).catch(()=>{}),y.current=null},350)}catch(O){}};return window.addEventListener("notificationsUpdated",j),pe.current&&clearInterval(pe.current),pe.current=setInterval(()=>{if(o&&l&&(g==="hod"||g==="staff"||g==="admin"))if(typeof requestIdleCallback=="function")try{requestIdleCallback(()=>S(l,g),{timeout:2e3})}catch(O){S(l,g)}else S(l,g)},3e4),()=>{window.removeEventListener("authStateChanged",w),window.removeEventListener("notificationsUpdated",j),window.removeEventListener("resize",d),window.removeEventListener("orientationchange",d),y.current&&(clearTimeout(y.current),y.current=null),u.current&&(clearTimeout(u.current),u.current=null),pe.current&&clearInterval(pe.current)}},[o,l,g]),i.useEffect(()=>{try{window.refreshNotificationCount=()=>{try{o&&l&&g&&S(l,g,!0)}catch(d){}}}catch(d){}return()=>{try{delete window.refreshNotificationCount}catch(d){}}},[o,l,g]),i.useEffect(()=>{if(typeof navigator<"u"&&navigator.serviceWorker){navigator.serviceWorker.getRegistrations().then(w=>{w&&w.length>0?V("registered"):navigator.serviceWorker.controller?V("controlled"):V("none")}).catch(()=>V("error"));const d=w=>{try{const j=w==null?void 0:w.data;if(!j)return;j.type==="SW_STATUS"&&V(j.status||"unknown")}catch(j){}};return navigator.serviceWorker.addEventListener&&navigator.serviceWorker.addEventListener("message",d),()=>{navigator.serviceWorker.removeEventListener&&navigator.serviceWorker.removeEventListener("message",d)}}},[o,g]);const E=()=>{const d=localStorage.getItem("auth");if(d)try{const w=JSON.parse(d);n(w.isAuthenticated||!1),p(w.email||""),M(w.role||""),(w.role==="hod"||w.role==="staff"||w.role==="admin")&&w.email&&S(w.email,w.role)}catch(w){console.error("Error parsing auth data:",w);const j=localStorage.getItem("isLoggedIn")==="true",O=localStorage.getItem("userEmail"),de=localStorage.getItem("userRole");n(j),p(O||""),M(de||""),(de==="hod"||de==="staff"||de==="admin")&&O&&S(O,de)}else{const w=localStorage.getItem("isLoggedIn")==="true",j=localStorage.getItem("userEmail"),O=localStorage.getItem("userRole");n(w),p(j||""),M(O||""),(O==="hod"||O==="staff"||O==="admin")&&j&&S(j,O)}},S=async(d,w,j=!1)=>{var O,de,b,be,le;try{if(w==="hod"){const v=JSON.parse(localStorage.getItem("auth")||"{}"),F=(v==null?void 0:v.id)||((O=v.user)==null?void 0:O.id),P=(v==null?void 0:v.department)||((de=v.user)==null?void 0:de.department);if(F&&P){const q=j?{cache:!1,dedupe:!1}:{},[D,z]=await Promise.all([U.get("/api/staff-approval?action=pending&hodId=".concat(F),q),U.get("/api/leaves?department=".concat(P,"&type=leave"),q)]);let ae=0,Q=0;D.success&&D.requests&&(ae=D.requests.length),z.success&&z.requests&&(Q=z.requests.filter(me=>me.status==="requested").length),T(ae+Q)}}else if(w==="staff"){const v=JSON.parse(localStorage.getItem("auth")||"{}"),F=(v==null?void 0:v.year)||((b=v.user)==null?void 0:b.year),P=(v==null?void 0:v.section)||((be=v.user)==null?void 0:be.section),q=(v==null?void 0:v.department)||((le=v.user)==null?void 0:le.department);let D=0;const z=await U.get("/api/notifications?userEmail=".concat(d),j?{cache:!1,dedupe:!1}:{});if(z!=null&&z.success&&z.notifications.find(Q=>{var me,A,we;return Q.type==="staff_account_approval"&&((me=Q.data)==null?void 0:me.staffEmail)===d&&!Q.read&&(((A=Q.data)==null?void 0:A.status)==="approved"||((we=Q.data)==null?void 0:we.status)==="rejected")})&&(D+=1),F&&P&&q)try{const ae=await U.get("/api/leaves?department=".concat(q,"&type=late&status=requested"),j?{cache:!1,dedupe:!1}:{});if(ae.success&&ae.requests){const Q=(ae.requests||[]).filter(me=>{var A,we;return((A=me.studentDetails)==null?void 0:A.year)===F&&((we=me.studentDetails)==null?void 0:we.section)===P}).length;D+=Q}}catch(ae){console.error("Error fetching late arrivals:",ae)}T(D)}else if(w==="admin"){const v=await U.get("/api/notifications?userEmail=".concat(encodeURIComponent(d)),j?{cache:!1,dedupe:!1}:{});if(v!=null&&v.success&&Array.isArray(v.notifications)){const F=v.notifications.filter(P=>!P.read).length;T(F)}}}catch(v){console.error("Error fetching notification count:",v)}},ie=async d=>{if(N(d),!d.trim()){J([]),R(!1);return}H(!0),R(!0);try{const w=d.trim().toLowerCase(),j=localStorage.getItem("auth"),O=j?JSON.parse(j):null;if(!O){J([]),H(!1);return}const de=[];if(O.role==="staff"||O.role==="hod")try{let b="/api/marksheets?includeAll=true";if(O.role==="staff"){const le=O._id||O.id||localStorage.getItem("userId");b+="&staffId=".concat(le)}else O.role==="hod"&&(b+="&department=".concat(O.department));const be=await U.get(b);be.success&&be.marksheets.filter(v=>{var D,z;const F=(((D=v.studentDetails)==null?void 0:D.name)||"").toLowerCase(),P=(((z=v.studentDetails)==null?void 0:z.regNumber)||"").toLowerCase(),q=(v.examinationName||"").toLowerCase();return F.includes(w)||P.includes(w)||q.includes(w)}).slice(0,5).forEach(v=>{var F,P;de.push({type:"marksheet",id:v._id,title:((F=v.studentDetails)==null?void 0:F.name)||"Unknown Student",subtitle:"".concat(((P=v.studentDetails)==null?void 0:P.regNumber)||""," ‚Ä¢ ").concat(v.examinationName||""),status:v.status,link:"/marksheets/".concat(v._id)})})}catch(b){console.error("Error searching marksheets:",b)}if(O.role==="hod")try{const b=await U.get("/api/users?department=".concat(O.department));b.success&&b.users.filter(le=>{const v=(le.name||"").toLowerCase(),F=(le.email||"").toLowerCase();return v.includes(w)||F.includes(w)}).slice(0,3).forEach(le=>{de.push({type:"user",id:le._id,title:le.name||le.email,subtitle:"".concat(le.role||"Staff"," ‚Ä¢ ").concat(le.email||""),link:"/department-overview"})})}catch(b){console.error("Error searching users:",b)}J(de)}catch(w){console.error("Search error:",w),J([])}H(!1)},L=d=>{d==null||d.preventDefault(),h.trim()&&B.length>0?(r(B[0].link),N(""),J([]),R(!1)):h.trim()&&(r("/records?search=".concat(encodeURIComponent(h.trim()))),N(""),R(!1))},Z=(d,w)=>{d.preventDefault(),d.stopPropagation(),R(!1),N(""),J([]),setTimeout(()=>{r(w)},0)};return a("header",{className:"sticky top-0 z-50 glass-card flex items-center justify-between whitespace-nowrap px-3 sm:px-4 md:px-6 lg:px-8 xl:px-10 py-3 sm:py-4 mx-2 sm:mx-3 md:mx-4 mt-2 sm:mt-3 md:mt-4",onMouseEnter:()=>{typeof document<"u"&&document.body.classList.add("header-hover-active")},onMouseLeave:()=>{typeof document<"u"&&document.body.classList.remove("header-hover-active")},children:[a("div",{className:"flex items-center gap-3 sm:gap-4 md:gap-6 lg:gap-8 flex-1 min-w-0",children:[a("div",{className:"flex items-center gap-2 md:gap-3 flex-shrink-0",children:[e("div",{className:"size-9 sm:size-10 md:size-10",children:e(Mr,{src:"/images/mseclogo.png",alt:"MSEC Logo",className:"w-full h-full",sizes:"(max-width:640px) 64px, 128px",widths:[64,128,256],lazy:!0})}),a("h2",{className:"text-base sm:text-lg md:text-xl font-bold leading-tight tracking-[-0.015em] whitespace-nowrap",children:[e("span",{className:"text-[#111418]",children:"MSEC"})," ",e("span",{className:"wave-text",children:"Academics"})]})]}),!s&&a("nav",{className:"hidden lg:flex items-center gap-4 xl:gap-5 2xl:gap-6 flex-shrink min-w-0",children:[o&&g==="student"?a(fe,{children:[e(K,{className:ne("/student"),to:"/student",title:"My Marksheets",children:"My Marksheets"}),e(K,{className:ne("/leave"),to:"/leave",title:"Leave/Late",children:"Leave/Late"})]}):e(K,{className:ne("/home"),to:"/home",title:"Dashboard",children:"Dashboard"}),o&&g==="staff"&&a(fe,{children:[e(K,{className:ne("/marksheets"),to:"/marksheets",title:"Marksheets",children:"Marksheets"}),a(K,{className:ne("/dispatch-requests"),to:"/dispatch-requests",title:"Dispatch Requests",children:[e("span",{className:"hidden xl:inline",children:"Dispatch Requests"}),e("span",{className:"xl:hidden",children:"Dispatch"})]}),e(K,{className:ne("/records"),to:"/records",title:"Records",children:"Records"})]}),o&&g==="hod"&&a(fe,{children:[a(K,{className:ne("/department-overview"),to:"/department-overview",title:"Department Overview",children:[e("span",{className:"hidden xl:inline",children:"Department Overview"}),e("span",{className:"xl:hidden",children:"Department"})]}),a(K,{className:ne("/approval-requests"),to:"/approval-requests",title:"Approval Requests",children:[e("span",{className:"hidden xl:inline",children:"Approval Requests"}),e("span",{className:"xl:hidden",children:"Approvals"})]}),e(K,{className:ne("/reports"),to:"/reports",title:"Reports",children:"Reports"})]}),!o||g!=="student"?e(K,{className:ne("/contact"),to:"/contact",title:"Contact",children:"Contact"}):null]})]}),!s&&a("div",{className:"hidden lg:flex items-center gap-2 lg:gap-3 xl:gap-4 flex-shrink-0",children:[a("form",{onSubmit:L,className:"relative !h-9 lg:!h-10 w-40 lg:w-48 xl:w-64",children:[e("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 text-[#60758a] pointer-events-none z-10",children:e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18px",height:"18px",fill:"currentColor",viewBox:"0 0 256 256",className:"lg:w-5 lg:h-5",children:e("path",{d:"M229.66,218.34l-50.07-50.06a88.11,88.11,0,1,0-11.31,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM40,112a72,72,0,1,1,72,72A72.08,72.08,0,0,1,40,112Z"})})}),e("input",{type:"text",value:h,onChange:d=>ie(d.target.value),onFocus:()=>B.length>0&&R(!0),onBlur:()=>setTimeout(()=>R(!1),300),placeholder:"Search students, exams...",className:"form-input w-full h-full text-[#111418] focus:outline-0 focus:ring-0 border border-white/10 bg-white/30 backdrop-blur-sm placeholder:text-[#60758a] pl-9 lg:pl-10 pr-3 text-xs lg:text-sm font-normal leading-normal rounded-lg lg:rounded-xl relative z-0",onKeyPress:d=>{d.key==="Enter"&&L(d)}}),se&&B.length>0&&e("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white rounded-xl shadow-xl border border-gray-200 overflow-hidden z-50 max-h-96 overflow-y-auto",children:x?e("div",{className:"p-4 text-center text-gray-500 text-sm",children:"Searching..."}):a(fe,{children:[B.map((d,w)=>e("button",{onClick:j=>Z(j,d.link),onMouseDown:j=>j.preventDefault(),className:"w-full px-4 py-3 hover:bg-gray-50 text-left border-b border-gray-100 last:border-b-0 transition-colors",children:a("div",{className:"flex items-start gap-3",children:[e("div",{className:"mt-0.5 w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0 ".concat(d.type==="marksheet"?"bg-blue-100 text-blue-600":d.type==="user"?"bg-green-100 text-green-600":"bg-gray-100 text-gray-600"),children:d.type==="marksheet"?"üìÑ":d.type==="user"?"üë§":"üìã"}),a("div",{className:"flex-1 min-w-0",children:[e("div",{className:"font-medium text-gray-900 text-sm truncate",children:d.title}),e("div",{className:"text-xs text-gray-500 truncate",children:d.subtitle}),d.status&&e("span",{className:"inline-block mt-1 px-2 py-0.5 rounded text-xs ".concat(d.status==="draft"?"bg-gray-100 text-gray-700":d.status==="verified_by_staff"?"bg-blue-100 text-blue-700":d.status==="dispatch_requested"?"bg-yellow-100 text-yellow-700":d.status==="approved_by_hod"?"bg-green-100 text-green-700":d.status==="dispatched"?"bg-purple-100 text-purple-700":"bg-red-100 text-red-700"),children:d.status.replace(/_/g," ")})]})]})},w)),h&&a("button",{onClick:d=>{d.preventDefault(),d.stopPropagation(),R(!1),N(""),setTimeout(()=>{r("/records?search=".concat(encodeURIComponent(h.trim())))},0)},onMouseDown:d=>d.preventDefault(),className:"w-full px-4 py-3 bg-gray-50 hover:bg-gray-100 text-left text-sm text-blue-600 font-medium transition-colors",children:['View all results for "',h,'"']})]})})]}),e("div",{className:"flex items-center gap-1 lg:gap-2 flex-shrink-0",children:o?a("div",{className:"flex items-center gap-1 lg:gap-2 relative",children:[a("button",{onClick:()=>$(!0),className:"hidden lg:flex items-center justify-center w-9 lg:w-10 h-9 lg:h-10 rounded-lg hover:bg-[#f0f2f5] transition-colors relative",title:"Notifications",children:[e(Je,{className:"w-5 h-5 text-[#60758a] hover:text-theme-gold transition-colors"}),W>0&&e("span",{className:"absolute -top-1 -right-1 min-w-[18px] h-[18px] px-1 bg-red-500 text-white text-[10px] font-bold rounded-full flex items-center justify-center animate-pulse shadow-lg",children:W>9?"9+":W})]}),a("button",{onClick:()=>_(!k),className:"flex items-center gap-2 px-2 lg:px-3 h-9 lg:h-10 rounded-lg hover:bg-[#f0f2f5] transition-colors group",title:"Settings",children:[e("div",{className:"w-7 lg:w-8 h-7 lg:h-8 rounded-full bg-theme-gold-gradient flex items-center justify-center flex-shrink-0",children:e("span",{className:"text-xs lg:text-sm font-bold text-white",children:(()=>{var d;if(g==="student")try{const w=JSON.parse(localStorage.getItem("auth")||"{}");return((d=w==null?void 0:w.name)==null?void 0:d.charAt(0).toUpperCase())||"S"}catch(w){return"S"}return l==null?void 0:l.charAt(0).toUpperCase()})()})}),e("span",{className:"text-xs lg:text-sm font-medium text-[#111418] hidden xl:inline truncate max-w-[120px] lg:max-w-[150px] group-hover:text-theme-gold",children:l}),e("svg",{className:"w-3 lg:w-4 h-3 lg:h-4 text-[#60758a] transition-transform ".concat(k?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}):e(K,{to:"/login",className:"flex min-w-[60px] lg:min-w-[70px] cursor-pointer items-center justify-center overflow-hidden rounded-lg lg:rounded-xl h-9 lg:h-10 px-3 lg:px-4 bg-theme-gold hover:bg-theme-gold-500 text-white text-xs lg:text-sm font-bold leading-normal tracking-[0.015em] whitespace-nowrap transition-all duration-200",children:e("span",{className:"truncate",children:"Login"})})})]}),!s&&a("div",{className:"lg:hidden flex items-center gap-1",children:[o&&a("button",{onClick:()=>$(!0),className:"flex items-center justify-center p-1.5 sm:p-2 text-[#111418] hover:bg-gray-100 rounded-lg transition-colors duration-200 flex-shrink-0 relative","aria-label":"Notifications",children:[e(Je,{className:"w-5 sm:w-6 h-5 sm:h-6"}),W>0&&e("span",{className:"absolute -top-1 -right-1 min-w-[18px] h-[18px] px-1 bg-red-500 text-white text-[10px] font-bold rounded-full flex items-center justify-center animate-pulse shadow-lg",children:W>9?"9+":W})]}),e("button",{onClick:()=>_(!0),className:"flex items-center justify-center p-1.5 sm:p-2 text-[#111418] hover:bg-gray-100 rounded-lg transition-colors duration-200 flex-shrink-0","aria-label":"Open settings",children:e("svg",{className:"w-5 sm:w-6 h-5 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})]}),!s&&m&&e("div",{className:"lg:hidden absolute top-full left-0 right-0 bg-white/95 backdrop-blur-md border-b border-[#f0f2f5] shadow-lg rounded-b-2xl mx-2 sm:mx-3 md:mx-4",children:a("div",{className:"flex flex-col p-4 sm:p-5 space-y-4 sm:space-y-5",children:[e("form",{onSubmit:L,className:"flex flex-col w-full",children:e("div",{className:"flex w-full items-stretch rounded-xl h-11 sm:h-12",children:a("div",{className:"relative w-full",children:[e("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 sm:pl-4 text-[#60758a] pointer-events-none z-10",children:e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18px",height:"18px",fill:"currentColor",viewBox:"0 0 256 256",className:"sm:w-5 sm:h-5",children:e("path",{d:"M229.66,218.34l-50.07-50.06a88.11,88.11,0,1,0-11.31,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM40,112a72,72,0,1,1,72,72A72.08,72.08,0,0,1,40,112Z"})})}),e("input",{type:"text",value:h,onChange:d=>N(d.target.value),placeholder:"Search",className:"form-input w-full h-full text-[#111418] focus:outline-0 focus:ring-0 border border-gray-200 bg-gray-50 placeholder:text-[#60758a] pl-10 sm:pl-12 pr-3 sm:pr-4 text-sm sm:text-base font-normal leading-normal rounded-xl relative z-0"})]})})}),a("nav",{className:"flex flex-col space-y-2 sm:space-y-3",children:[e(K,{className:"text-[#111418] text-sm sm:text-base font-medium py-2.5 sm:py-3 px-3 sm:px-4 hover:text-theme-gold-500 hover:bg-theme-gold-50 rounded-lg transition-all duration-200 mobile-nav-item",to:"/home",onClick:()=>f(!1),children:"Dashboard"}),o&&g==="staff"&&a(fe,{children:[e(K,{className:"text-[#111418] text-sm sm:text-base font-medium py-2.5 sm:py-3 px-3 sm:px-4 hover:text-theme-gold-500 hover:bg-theme-gold-50 rounded-lg transition-all duration-200 mobile-nav-item",to:"/marksheets",onClick:()=>f(!1),children:"Marksheets"}),e(K,{className:"text-[#111418] text-sm sm:text-base font-medium py-2.5 sm:py-3 px-3 sm:px-4 hover:text-theme-gold-500 hover:bg-theme-gold-50 rounded-lg transition-all duration-200 mobile-nav-item",to:"/dispatch-requests",onClick:()=>f(!1),children:"Dispatch Requests"}),e(K,{className:"text-[#111418] text-sm sm:text-base font-medium py-2.5 sm:py-3 px-3 sm:px-4 hover:text-theme-gold-500 hover:bg-theme-gold-50 rounded-lg transition-all duration-200 mobile-nav-item",to:"/records",onClick:()=>f(!1),children:"Records"})]}),o&&g==="hod"&&a(fe,{children:[e(K,{className:"text-[#111418] text-sm sm:text-base font-medium py-2.5 sm:py-3 px-3 sm:px-4 hover:text-theme-gold-500 hover:bg-theme-gold-50 rounded-lg transition-all duration-200 mobile-nav-item",to:"/department-overview",onClick:()=>f(!1),children:"Department Overview"}),e(K,{className:"text-[#111418] text-sm sm:text-base font-medium py-2.5 sm:py-3 px-3 sm:px-4 hover:text-theme-gold-500 hover:bg-theme-gold-50 rounded-lg transition-all duration-200 mobile-nav-item",to:"/approval-requests",onClick:()=>f(!1),children:"Approval Requests"}),e(K,{className:"text-[#111418] text-sm sm:text-base font-medium py-2.5 sm:py-3 px-3 sm:px-4 hover:text-theme-gold-500 hover:bg-theme-gold-50 rounded-lg transition-all duration-200 mobile-nav-item",to:"/reports",onClick:()=>f(!1),children:"Reports"})]})]}),e("div",{className:"flex flex-col gap-3 sm:gap-4 pt-3 sm:pt-4 border-t border-[#f0f2f5]",children:o?a(fe,{children:[a("button",{onClick:()=>{_(!k),f(!1)},className:"flex items-center gap-3 sm:gap-4 p-3 sm:p-4 rounded-xl bg-gray-50 hover:bg-gray-100 transition-colors duration-200",children:[e("div",{className:"w-10 sm:w-12 h-10 sm:h-12 rounded-full bg-theme-gold-gradient flex items-center justify-center flex-shrink-0",children:e("span",{className:"text-sm sm:text-base font-bold text-white",children:(()=>{var d;if(g==="student")try{const w=JSON.parse(localStorage.getItem("auth")||"{}");return((d=w==null?void 0:w.name)==null?void 0:d.charAt(0).toUpperCase())||"S"}catch(w){return"S"}return l==null?void 0:l.charAt(0).toUpperCase()})()})}),a("div",{className:"flex-1 text-left min-w-0",children:[e("p",{className:"text-sm sm:text-base font-medium text-[#111418] truncate",children:l}),e("p",{className:"text-xs sm:text-sm text-[#60758a] capitalize",children:g})]}),a("svg",{className:"w-4 sm:w-5 h-4 sm:h-5 text-[#60758a] flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})]}),g==="staff"&&e(K,{to:"/marksheets",className:"flex items-center justify-center rounded-xl h-11 sm:h-12 px-4 bg-theme-gold hover:bg-theme-gold-500 text-white text-sm sm:text-base font-bold mobile-btn tablet-btn desktop-btn transition-all duration-200",onClick:()=>f(!1),children:"Go to Marksheets"}),g==="hod"&&e(K,{to:"/approval-requests",className:"flex items-center justify-center rounded-xl h-11 sm:h-12 px-4 bg-theme-gold hover:bg-theme-gold-500 text-white text-sm sm:text-base font-bold mobile-btn tablet-btn desktop-btn transition-all duration-200",onClick:()=>f(!1),children:"Approval Requests"})]}):a("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:[e(K,{to:"/login",className:"flex-1 flex items-center justify-center rounded-xl h-11 sm:h-12 px-4 bg-theme-gold hover:bg-theme-gold-500 text-white text-sm sm:text-base font-bold mobile-btn tablet-btn desktop-btn transition-all duration-200",onClick:()=>f(!1),children:"Login"}),e(K,{to:"/login",className:"flex-1 flex items-center justify-center rounded-xl h-11 sm:h-12 px-4 border-2 border-theme-gold text-theme-gold hover:bg-theme-gold hover:text-white text-sm sm:text-base font-bold transition-all duration-200",onClick:()=>f(!1),children:"Get Started"})]})})]})}),k&&e(Ir,{isOpen:k,onClose:()=>_(!1),userEmail:l,userRole:g,isMobile:X}),e(Tr,{isOpen:re,onClose:()=>{$(!1),l&&g&&S(l,g)},setUnreadCount:T})]})}function Or(){const t=Xe(),[r,s]=i.useState(""),[o,n]=i.useState(!1),[l,p]=i.useState(0);i.useEffect(()=>{g();const f=()=>{g()};window.addEventListener("authStateChanged",f);const k=()=>M(!0);return window.addEventListener("notificationsUpdated",k),window.addEventListener("marksheetsUpdated",k),()=>{window.removeEventListener("authStateChanged",f),window.removeEventListener("notificationsUpdated",k),window.removeEventListener("marksheetsUpdated",k)}},[]),i.useEffect(()=>{if(o){M();const f=setInterval(M,3e4);return()=>clearInterval(f)}},[o]);const g=()=>{const f=localStorage.getItem("auth");if(f)try{const k=JSON.parse(f);n(k.isAuthenticated||!1),s(k.role||"")}catch(k){n(!1),s("")}},M=async(f=!1)=>{var k,_;try{const re=localStorage.getItem("auth");if(!re)return;const $=JSON.parse(re),W=encodeURIComponent($.email||((k=$.user)==null?void 0:k.email)||"");if(!W)return;const T=f?{cache:!1,dedupe:!1}:void 0,B=await U.get("/api/notifications?userEmail=".concat(W,"&unreadOnly=true"),T);B!=null&&B.success&&p(((_=B.notifications)==null?void 0:_.length)||0)}catch(re){console.debug("Could not fetch notifications:",re.message)}},h=()=>{const f=[{name:"Home",path:"/home",icon:e("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})}];return r==="staff"?[...f,{name:"Marksheets",path:"/marksheets",icon:e("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})},{name:"Requests",path:"/dispatch-requests",icon:e("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})},{name:"Records",path:"/records",icon:e("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}]:r==="hod"?[...f,{name:"Overview",path:"/department-overview",icon:e("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})},{name:"Approvals",path:"/approval-requests",icon:e("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})},{name:"Reports",path:"/reports",icon:e("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}]:r==="student"?[{name:"My Marksheets",path:"/student",icon:e("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})},{name:"Leave/Late",path:"/leave",icon:e("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}]:f},N=f=>f==="/home"?t.pathname==="/"||t.pathname==="/home":t.pathname.startsWith(f);if(!o)return null;const m=h();return e("nav",{className:"md:hidden fixed bottom-0 left-0 right-0 z-40 bg-white/95 backdrop-blur-md border-t border-gray-200 shadow-lg safe-area-inset-bottom",style:{transform:"translateZ(0)",willChange:"transform"},children:e("div",{className:"flex items-center justify-around px-2 py-2",children:m.map(f=>a(K,{to:f.path,className:"flex flex-col items-center justify-center px-3 py-2 rounded-lg transition-all duration-200 min-w-[60px] ".concat(N(f.path)?"text-theme-gold bg-theme-gold-50":"text-gray-600 hover:text-theme-gold-500 hover:bg-gray-50"),children:[a("div",{className:"relative",children:[f.icon,f.name==="Profile"&&l>0&&e("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center font-bold",children:l>9?"9+":l})]}),e("span",{className:"text-xs mt-1 font-medium ".concat(N(f.path)?"font-bold":""),children:f.name})]},f.path))})})}function zr(){const t=()=>{document.body.style.overflow==="hidden"&&(document.querySelector('[role="dialog"]')||document.querySelector(".modal")||document.querySelector('[data-modal-open="true"]')||(console.warn("Body overflow was stuck as hidden, fixing..."),document.body.style.overflow="")),document.documentElement.style.height="auto",document.documentElement.style.minHeight="100%",document.documentElement.style.overflowY="auto",document.documentElement.style.overflowX="hidden",document.body.style.overflow!=="hidden"&&(document.body.style.height="auto",document.body.style.minHeight="100%",document.body.style.overflowY="auto",document.body.style.overflowX="hidden"),document.documentElement.style.touchAction="auto",document.body.style.touchAction="auto";const s="force-scroll-style";if(!document.getElementById(s)){const o=document.createElement("style");o.id=s,o.innerHTML="\n            * { \n                touch-action: pan-y !important; \n                overscroll-behavior: auto !important; \n            }\n            .no-scroll {\n                touch-action: none !important;\n            }\n        ",document.head.appendChild(o)}};t(),setTimeout(t,100),setTimeout(t,500),setTimeout(t,1e3),setTimeout(t,2e3);const r=setInterval(t,2e3);return()=>clearInterval(r)}typeof window<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{document.body.style.overflow="",document.body.style.overflowY="auto",document.body.style.height="auto",document.body.style.minHeight="100%",document.documentElement.style.height="auto",document.documentElement.style.minHeight="100%",document.documentElement.style.overflowY="auto"}):(document.body.style.overflow="",document.body.style.overflowY="auto",document.body.style.height="auto",document.body.style.minHeight="100%",document.documentElement.style.height="auto",document.documentElement.style.minHeight="100%",document.documentElement.style.overflowY="auto"),window.addEventListener("load",()=>{setTimeout(()=>{document.body.style.overflow="",document.body.style.overflowY="auto",document.documentElement.style.overflowY="auto",document.body.offsetHeight},100)}));function Ie(){try{const t=localStorage.getItem("auth");if(!t)return null;const r=JSON.parse(t);return!r||typeof r!="object"?null:r}catch(t){return localStorage.removeItem("auth"),localStorage.removeItem("isLoggedIn"),localStorage.removeItem("userEmail"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),null}}const Wr=i.lazy(()=>Y(()=>import("./Home-7595991b.js"),["assets/js/Home-7595991b.js","assets/js/react-vendor-ad4d5528.js"])),$r=i.lazy(()=>Y(()=>import("./ImportMarks-ea58dded.js"),["assets/js/ImportMarks-ea58dded.js","assets/js/react-vendor-ad4d5528.js"])),Ur=i.lazy(()=>Y(()=>import("./Marksheets-869103a7.js"),["assets/js/Marksheets-869103a7.js","assets/js/react-vendor-ad4d5528.js","assets/js/ConfirmDialog-600f2ec4.js","assets/js/Confetti-08d02b59.js","assets/js/ContextualHelp-f7e4e1d9.js","assets/js/resultUtils-190b400a.js","assets/js/usePullToRefresh-466afb4d.js"])),Br=i.lazy(()=>Y(()=>import("./MarksheetDetails-05e94e3a.js"),["assets/js/MarksheetDetails-05e94e3a.js","assets/js/react-vendor-ad4d5528.js","assets/js/resultUtils-190b400a.js"])),Hr=i.lazy(()=>Y(()=>import("./DispatchRequests-6b2580fb.js"),["assets/js/DispatchRequests-6b2580fb.js","assets/js/react-vendor-ad4d5528.js","assets/js/RefreshButton-efbc2ae6.js","assets/js/usePullToRefresh-466afb4d.js"])),Fr=i.lazy(()=>Y(()=>import("./Records-700c1ae1.js"),["assets/js/Records-700c1ae1.js","assets/js/react-vendor-ad4d5528.js","assets/js/resultUtils-190b400a.js"])),qr=i.lazy(()=>Y(()=>import("./DepartmentOverview-5d8cff3b.js"),["assets/js/DepartmentOverview-5d8cff3b.js","assets/js/react-vendor-ad4d5528.js"])),Vr=i.lazy(()=>Y(()=>import("./ApprovalRequests-cbb2ce99.js"),["assets/js/ApprovalRequests-cbb2ce99.js","assets/js/react-vendor-ad4d5528.js","assets/js/RefreshButton-efbc2ae6.js","assets/js/Confetti-08d02b59.js","assets/js/ContextualHelp-f7e4e1d9.js","assets/js/usePullToRefresh-466afb4d.js"])),Yr=i.lazy(()=>Y(()=>import("./Reports-fc4e26b5.js"),["assets/js/Reports-fc4e26b5.js","assets/js/react-vendor-ad4d5528.js","assets/js/ContextualHelp-f7e4e1d9.js","assets/js/resultUtils-190b400a.js"])),Jr=i.lazy(()=>Y(()=>import("./Login-7a8cdf35.js"),["assets/js/Login-7a8cdf35.js","assets/js/react-vendor-ad4d5528.js"])),Gr=i.lazy(()=>Y(()=>import("./SignUp-97acb58f.js"),["assets/js/SignUp-97acb58f.js","assets/js/react-vendor-ad4d5528.js"])),Xr=i.lazy(()=>Y(()=>import("./Contact-93ae408b.js"),["assets/js/Contact-93ae408b.js","assets/js/react-vendor-ad4d5528.js"])),Kr=i.lazy(()=>Y(()=>import("./StudentDashboard-94a3ba85.js"),["assets/js/StudentDashboard-94a3ba85.js","assets/js/react-vendor-ad4d5528.js"])),Zr=i.lazy(()=>Y(()=>import("./Leave-0fc2259a.js"),["assets/js/Leave-0fc2259a.js","assets/js/react-vendor-ad4d5528.js","assets/js/Confetti-08d02b59.js","assets/js/ConfirmDialog-600f2ec4.js"])),Qr=i.lazy(()=>Y(()=>import("./LeaveApprovals-bcca98a9.js"),["assets/js/LeaveApprovals-bcca98a9.js","assets/js/react-vendor-ad4d5528.js","assets/js/usePullToRefresh-466afb4d.js"])),ea=i.lazy(()=>Y(()=>import("./LateAcknowledgment-89533229.js"),["assets/js/LateAcknowledgment-89533229.js","assets/js/react-vendor-ad4d5528.js"])),ta=i.lazy(()=>Y(()=>import("./PrivacyPolicy-d49499ba.js"),["assets/js/PrivacyPolicy-d49499ba.js","assets/js/react-vendor-ad4d5528.js"])),ra=i.lazy(()=>Y(()=>import("./TermsOfService-ddcd5716.js"),["assets/js/TermsOfService-ddcd5716.js","assets/js/react-vendor-ad4d5528.js"])),aa=i.lazy(()=>Y(()=>import("./FAQ-fa30ef7e.js"),["assets/js/FAQ-fa30ef7e.js","assets/js/react-vendor-ad4d5528.js"])),sa=i.lazy(()=>Y(()=>import("./NotFound-94da1f5f.js"),["assets/js/NotFound-94da1f5f.js","assets/js/react-vendor-ad4d5528.js"])),oa=i.lazy(()=>Y(()=>import("./AdminDashboard-d750ab9b.js"),["assets/js/AdminDashboard-d750ab9b.js","assets/js/react-vendor-ad4d5528.js","assets/js/ConfirmDialog-600f2ec4.js"])),na=()=>{const t=Ie();return t?t.role==="student"?e(ue,{to:"/student",replace:!0}):t.role==="admin"?e(ue,{to:"/admin-dashboard",replace:!0}):e(ue,{to:"/home",replace:!0}):e(ue,{to:"/login",replace:!0})},ia=()=>{const t=Ie();return t?t.role==="student"?e(ue,{to:"/student",replace:!0}):t.role==="admin"?e(ue,{to:"/admin-dashboard",replace:!0}):e(Wr,{}):e(ue,{to:"/login",replace:!0})},la=()=>{const t=Ie();return t?t.role!=="student"?e(ue,{to:"/home",replace:!0}):e(Kr,{}):e(ue,{to:"/login",replace:!0})},ca=()=>{const t=Ie();return t?t.role!=="admin"?e(ue,{to:"/home",replace:!0}):e(oa,{}):e(ue,{to:"/login",replace:!0})},xe=({children:t})=>{const r=Ie();return r?r.role==="student"?e(ue,{to:"/student",replace:!0}):r.role==="admin"?e(ue,{to:"/admin-dashboard",replace:!0}):r.role!=="staff"&&r.role!=="hod"?e(ue,{to:"/home",replace:!0}):t:e(ue,{to:"/login",replace:!0})},ut=({children:t})=>{const r=Ie();return r?r.role==="student"?e(ue,{to:"/student",replace:!0}):r.role==="admin"?e(ue,{to:"/admin-dashboard",replace:!0}):e(ue,{to:"/home",replace:!0}):t};function da(){const t=Xe(),r=t.pathname==="/login"||t.pathname==="/signup";return i.useEffect(()=>{if(!r)document.body.style.backgroundImage="none";else try{const s="image-set(url('/images/campus.avif') type('image/avif') 1x, url('/images/campus.webp') type('image/webp') 1x, url('/images/campus.jpeg') 1x)";typeof CSS<"u"&&CSS.supports&&CSS.supports("background-image",s)?document.body.style.backgroundImage=s:typeof CSS<"u"&&CSS.supports&&CSS.supports("background-image","url('/images/campus.webp')")?document.body.style.backgroundImage="url('/images/campus.webp')":document.body.style.backgroundImage="url('/images/campus.jpeg')"}catch(s){document.body.style.backgroundImage="url('/images/campus.jpeg')"}},[r]),i.useEffect(()=>{U.get("/api/generate-pdf?test=true").catch(()=>{})},[]),a(fe,{children:[a("div",{className:"flex w-full flex-col ".concat(r?"relative":""),style:{fontFamily:"Inter, Manrope, sans-serif",WebkitOverflowScrolling:"touch",minHeight:"100vh",height:"auto",overflow:"visible",overflowY:"auto",overflowX:"hidden"},children:[r&&e("div",{className:"fixed inset-0 bg-black/40 z-0 pointer-events-none"}),a("div",{className:"layout-container flex min-h-screen flex-col max-w-full ".concat(r?"relative z-10":"bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50"),children:[e(jr,{}),e("div",{className:"flex flex-1 justify-center w-full",children:e("div",{className:"layout-content-container flex flex-col w-full max-w-full ".concat(r?"":"pb-20 md:pb-0"),children:a(Tt,{children:[e(te,{path:"/",element:e(na,{})}),e(te,{path:"/home",element:e(i.Suspense,{fallback:e(ze,{}),children:e(ia,{})})}),e(te,{path:"/student",element:e(i.Suspense,{fallback:e(ze,{}),children:e(la,{})})}),e(te,{path:"/admin-dashboard",element:e(i.Suspense,{fallback:e(ze,{}),children:e(ca,{})})}),e(te,{path:"/leave",element:e(i.Suspense,{fallback:e(ot,{}),children:e(Zr,{})})}),e(te,{path:"/import-marks",element:e(i.Suspense,{fallback:e(ot,{}),children:e(xe,{children:e($r,{})})})}),e(te,{path:"/marksheets",element:e(i.Suspense,{fallback:e(st,{}),children:e(xe,{children:e(Ur,{})})})}),e(te,{path:"/marksheets/:id",element:e(i.Suspense,{fallback:e(Ht,{}),children:e(xe,{children:e(Br,{})})})}),e(te,{path:"/dispatch-requests",element:e(i.Suspense,{fallback:e(Ft,{}),children:e(xe,{children:e(Hr,{})})})}),e(te,{path:"/records",element:e(i.Suspense,{fallback:e(qt,{}),children:e(xe,{children:e(Fr,{})})})}),e(te,{path:"/department-overview",element:e(i.Suspense,{fallback:e(ze,{}),children:e(xe,{children:e(qr,{})})})}),e(te,{path:"/approval-requests",element:e(i.Suspense,{fallback:e(nt,{}),children:e(xe,{children:e(Vr,{})})})}),e(te,{path:"/leave-approvals",element:e(i.Suspense,{fallback:e(nt,{}),children:e(xe,{children:e(Qr,{})})})}),e(te,{path:"/late-acknowledgment",element:e(i.Suspense,{fallback:e(st,{}),children:e(xe,{children:e(ea,{})})})}),e(te,{path:"/reports",element:e(i.Suspense,{fallback:e(Vt,{}),children:e(xe,{children:e(Yr,{})})})}),e(te,{path:"/login",element:e(i.Suspense,{fallback:e(Zt,{}),children:e(ut,{children:e(Jr,{})})})}),e(te,{path:"/signup",element:e(i.Suspense,{fallback:e(Qt,{}),children:e(ut,{children:e(Gr,{})})})}),e(te,{path:"/contact",element:e(i.Suspense,{fallback:e(Xt,{}),children:e(Xr,{})})}),e(te,{path:"/privacy-policy",element:e(i.Suspense,{fallback:e(Jt,{}),children:e(ta,{})})}),e(te,{path:"/terms-of-service",element:e(i.Suspense,{fallback:e(Gt,{}),children:e(ra,{})})}),e(te,{path:"/faq",element:e(i.Suspense,{fallback:e(Yt,{}),children:e(aa,{})})}),e(te,{path:"*",element:e(i.Suspense,{fallback:e(Kt,{}),children:e(sa,{})})})]})})})]})]}),!r&&e(Or,{})]})}function mt(){const t={v7_startTransition:!0,v7_relativeSplatPath:!0};return i.useEffect(()=>zr(),[]),e(er,{children:e(Nr,{children:e(Dt,{future:t,children:e(da,{})})})})}window.addEventListener("unhandledrejection",t=>{const r=t.reason&&(t.reason.message||t.reason.error||t.reason);if(typeof r=="string"&&(r.includes("Receiving end does not exist")||r.includes("Could not establish connection"))){t.preventDefault();return}if(typeof r=="string"&&(r.includes("Invalid registration number")||r.includes("Invalid email or password")||r.includes("Invalid email or password")||r.includes("Registration number and password are required"))){try{t.preventDefault()}catch(s){}try{window.dispatchEvent(new CustomEvent("api:auth-failed",{detail:{message:r}}))}catch(s){}return}});var gt,ft;typeof navigator<"u"&&"serviceWorker"in navigator&&((ft=(gt=navigator.serviceWorker).addEventListener)==null||ft.call(gt,"message",t=>{try{const r=t&&t.data?t.data:null;if(!r||!r.type)return;if(r.type==="RELOAD_REQUEST"){console.info("Service worker requested reload (dispatching event):",r.reason||"unknown");try{window.dispatchEvent(new CustomEvent("sw:reload-request",{detail:{reason:r.reason}}))}catch(s){setTimeout(()=>{try{window.location.reload()}catch(o){}},150)}}else if(r.type==="NOTIFICATION_RECEIVED")try{Y(()=>import("./notificationEvents-12cfbdaf.js"),[]).then(s=>{try{s.notifyNotificationsUpdated(r,300)}catch(o){try{window.dispatchEvent(new CustomEvent("notificationsUpdated",{detail:r}))}catch(n){}}}).catch(()=>{try{window.dispatchEvent(new CustomEvent("notificationsUpdated",{detail:r}))}catch(s){}})}catch(s){try{window.dispatchEvent(new Event("notificationsUpdated"))}catch(o){}}}catch(r){}}));const kt=document.getElementById("root");if(!kt)throw new Error("Root element not found");const ht=Ye.createRoot(kt);try{ht.render(e(pt.StrictMode,{children:e(mt,{})}))}catch(t){console.error("Failed to render app:",t),ht.render(e(mt,{}))}if(typeof window<"u"){async function t(){try{if("serviceWorker"in navigator){try{const r=await navigator.serviceWorker.getRegistrations();console.info("[sw-debug] registrations:",r.map(s=>({scope:s.scope,active:!!s.active,waiting:!!s.waiting})))}catch(r){console.warn("[sw-debug] getRegistrations failed",r)}try{console.info("[sw-debug] controller:",navigator.serviceWorker.controller)}catch(r){}}else console.info("[sw-debug] serviceWorker not supported in this browser");if("caches"in window)try{const r=await caches.keys();console.info("[sw-debug] CacheStorage keys:",r);for(const s of r)try{const n=await(await caches.open(s)).keys();console.info("[sw-debug] cache:".concat(s," entries:"),n.map(l=>l.url).slice(0,50))}catch(o){console.warn("[sw-debug] reading cache",s,o)}}catch(r){console.warn("[sw-debug] caches.keys failed",r)}else console.info("[sw-debug] CacheStorage not available")}catch(r){console.error("[sw-debug] unexpected error",r)}}setTimeout(()=>{t().catch(()=>{})},300),window.debugSWStatus=t}typeof navigator<"u"&&"serviceWorker"in navigator&&(async()=>{try{const t=await navigator.serviceWorker.getRegistrations();if(t&&t.length>0)console.info("[sw-auto] already registered",t.map(r=>r.scope));else{console.info("[sw-auto] attempting to register /service-worker.js");try{const r=await navigator.serviceWorker.register("/service-worker.js",{scope:"/"});console.info("[sw-auto] registration success",r.scope,r),await navigator.serviceWorker.ready,console.info("[sw-auto] service worker ready"),setTimeout(()=>{window.debugSWStatus&&window.debugSWStatus().catch(()=>{})},200)}catch(r){console.warn("[sw-auto] registration failed",r)}}}catch(t){console.warn("[sw-auto] failed to check/register",t)}})();typeof window<"u"&&(window.findCoveringElements=()=>{try{const r=Array.from(document.body.querySelectorAll("*")).filter(o=>{const n=o.getBoundingClientRect();return n.width>0&&n.height>0&&n.top<=0&&n.left<=0&&n.right>=window.innerWidth&&n.bottom>=window.innerHeight}),s=r.map(o=>({tag:o.tagName,id:o.id||null,class:o.className||null,zIndex:getComputedStyle(o).zIndex,pointerEvents:getComputedStyle(o).pointerEvents,position:getComputedStyle(o).position}));return console.info("[debug] covering elements:",s),r}catch(t){return console.warn("[debug] findCoveringElements failed",t),[]}},window.toggleCoveringPointerEvents=()=>{const t=window.findCoveringElements();t.forEach(r=>{try{const s=r.style.pointerEvents||getComputedStyle(r).pointerEvents;r.dataset.__origPointer=r.dataset.__origPointer||s,r.style.pointerEvents=s==="none"?r.dataset.__origPointer||"":"none"}catch(s){}}),console.info("[debug] toggled pointer-events on",t.length,"elements")},window.forceTempScroll=(t=2e3)=>{const r=document.documentElement.style.overflow,s=document.body.style.overflow;document.documentElement.style.overflow="auto",document.body.style.overflow="auto",console.info("[debug] forced overflow:auto for",t,"ms"),setTimeout(()=>{document.documentElement.style.overflow=r,document.body.style.overflow=s,console.info("[debug] restored overflow")},t)},window.addEventListener("keydown",t=>{t.ctrlKey&&t.shiftKey&&t.key.toLowerCase()==="d"&&(t.preventDefault(),window.findCoveringElements()),t.ctrlKey&&t.shiftKey&&t.key.toLowerCase()==="f"&&(t.preventDefault(),window.toggleCoveringPointerEvents()),t.ctrlKey&&t.shiftKey&&t.key.toLowerCase()==="s"&&(t.preventDefault(),window.forceTempScroll(2e3))}),window.disableVisualEffects=()=>{if(document.getElementById("debug-disable-visuals"))return;const t=document.createElement("style");t.id="debug-disable-visuals",t.innerHTML='\n      .backdrop-blur-sm, [class*="backdrop-blur"], .backdrop-blur-md, .glass-card, .settings-modal, .notification-card, .notification-container {\n        backdrop-filter: none !important;\n        -webkit-backdrop-filter: none !important;\n      }\n      * {\n        filter: none !important;\n        will-change: auto !important;\n        transform: none !important;\n      }\n    ',document.head.appendChild(t),console.info("[debug] visual effects disabled")},window.restoreVisualEffects=()=>{const t=document.getElementById("debug-disable-visuals");t&&t.remove(),console.info("[debug] visual effects restored")},window.startTouchTrace=(t=200)=>{if(window.__touchTraceRunning)return console.info("[touch-trace] already running");window.__touchTrace=[],window.__touchTraceRunning=!0;const r=s=>{try{const o=s.touches&&s.touches[0]?s.touches[0]:s.changedTouches&&s.changedTouches[0]||{},n={time:Date.now(),type:s.type,target:s.target&&(s.target.tagName||s.target.nodeName),id:s.target&&(s.target.id||null),class:s.target&&(s.target.className||null),x:o.clientX||null,y:o.clientY||null,defaultPrevented:s.defaultPrevented};window.__touchTrace.push(n),window.__touchTrace.length>t&&window.__touchTrace.shift(),console.debug("[touch-trace]",n.type,n.target,"dp=",n.defaultPrevented)}catch(o){}};window.__touchTraceHandlers={touchstart:s=>r(s),touchmove:s=>r(s),touchend:s=>r(s)},document.addEventListener("touchstart",window.__touchTraceHandlers.touchstart,{passive:!0}),document.addEventListener("touchmove",window.__touchTraceHandlers.touchmove,{passive:!0}),document.addEventListener("touchend",window.__touchTraceHandlers.touchend,{passive:!0}),console.info("[touch-trace] started (check window.__touchTrace for recent events)")},window.stopTouchTrace=()=>{if(!window.__touchTraceRunning)return console.info("[touch-trace] not running");document.removeEventListener("touchstart",window.__touchTraceHandlers.touchstart),document.removeEventListener("touchmove",window.__touchTraceHandlers.touchmove),document.removeEventListener("touchend",window.__touchTraceHandlers.touchend),window.__touchTraceRunning=!1,console.info("[touch-trace] stopped")});export{ga as B,_e as C,fe as F,Mr as R,Nt as S,Be as X,Y as _,ma as __vite_legacy_guard,U as a,a as b,ye as c,Rr as d,fa as e,mr as f,tr as g,cr as h,e as j,kr as u};
