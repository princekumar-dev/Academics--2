System.register(["./index-legacy-b6735175.js","./react-vendor-legacy-4587369d.js"],function(e,t){"use strict";var a,s,r,i,n,c;return{setters:[e=>{a=e.j,s=e.u,r=e.b,i=e.a},e=>{n=e.N,c=e.r}],execute:function(){e("default",function(){const e=localStorage.getItem("auth"),t=e?JSON.parse(e):null;if(!t||"staff"!==t.role)return a(n,{to:"/home",replace:!0});const{showSuccess:l,showError:d}=s(),[o,u]=c.useState([]),[m,h]=c.useState(!1),f=async()=>{try{h(!0);const e=new URLSearchParams({department:t.department,type:"late",status:"requested"}),a=await i.get(`/api/leaves?${e.toString()}`);if(a.success){const e=(a.requests||[]).filter(e=>e.studentDetails?.year===t.year&&e.studentDetails?.section===t.section);u(e)}}catch(e){}finally{h(!1)}};return c.useEffect(()=>{f()},[]),r("div",{className:"px-4 py-4 w-full max-w-4xl mx-auto",children:[a("h1",{className:"text-2xl font-bold mb-4",children:"Late Acknowledgment"}),m?a("div",{className:"p-4 text-gray-500",children:"Loading..."}):r("ul",{className:"divide-y bg-white rounded-xl shadow",children:[o.map(e=>{return r("li",{className:"p-4 flex items-center justify-between",children:[r("div",{children:[r("div",{className:"font-medium",children:[e.studentDetails?.name," (",e.studentDetails?.regNumber,")"]}),r("div",{className:"text-sm text-gray-600",children:["Expected: ",(s=e.expectedArrivalTime,s?new Date(s).toLocaleString("en-IN",{dateStyle:"medium",timeStyle:"short"}):"-")]}),r("div",{className:"text-sm text-gray-600",children:["Reason: ",e.reason]})]}),a("div",{className:"flex gap-2",children:a("button",{onClick:()=>(async e=>{try{const s=await i.patch(`/api/leaves?id=${e}&action=acknowledge`,{staffId:t.id});if(s&&s.success){l("Acknowledged","Late arrival recorded and parent notified"),f();try{window.refreshNotificationCount&&window.refreshNotificationCount()}catch(a){}}else d("Failed",s?.error||"Could not acknowledge request")}catch(s){d("Error",s.message)}})(e._id),className:"px-3 py-2 text-sm rounded-lg bg-blue-600 text-white",children:"Record Arrival"})})]},e._id);var s}),0===o.length&&a("li",{className:"p-4 text-gray-500",children:"No pending late notifications."})]})]})})}}});
