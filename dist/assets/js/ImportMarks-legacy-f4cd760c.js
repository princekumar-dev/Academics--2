System.register(["./index-legacy-539dcb9c.js","./react-vendor-legacy-4587369d.js"],function(e,t){"use strict";var l,a,r,n,s;return{setters:[e=>{l=e.j,a=e.b,r=e.a,n=e.g},e=>{s=e.r}],execute:function(){e("default",function(){const[e,t]=s.useState(()=>{const e=localStorage.getItem("auth");return e?JSON.parse(e):null}),[i,c]=s.useState(null),[d,o]=s.useState(!1),[m,x]=s.useState(""),[u,h]=s.useState(null),[p,g]=s.useState([]);return e&&"staff"===e.role?l("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:l("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8",children:a("div",{className:"max-w-4xl mx-auto",children:[a("div",{className:"text-center mb-8",children:[l("h1",{className:"text-4xl sm:text-5xl lg:text-6xl font-black text-gray-900 mb-4",children:"Import Student Marks"}),a("p",{className:"text-lg text-gray-600 max-w-3xl mx-auto",children:["Upload Excel file with student marks data for ",e.department," Department - Year ",e.year]})]}),a("div",{className:"glass-card p-8 rounded-3xl mb-8",children:[a("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-12 text-center",children:[l("svg",{className:"w-16 h-16 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),l("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Drop Excel file here"}),l("p",{className:"text-gray-600 mb-6",children:"or click to browse"}),l("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:e=>{e.target.files&&e.target.files[0]&&c(e.target.files[0])},className:"hidden",id:"excelFile"}),l("label",{htmlFor:"excelFile",className:"glass-button px-6 py-3 text-blue-600 rounded-xl font-bold cursor-pointer inline-block",children:i?"Change File":"Choose File"}),i&&a("div",{className:"mt-4 text-gray-700",children:["Selected: ",l("span",{className:"font-semibold",children:i.name})]}),l("div",{className:"mt-6",children:l("button",{disabled:!i||d,onClick:async()=>{if(i){o(!0),g([]),h(null);try{const l=new FormData;l.append("excelFile",i),l.append("staffId",e.id),l.append("examinationDate",(new Date).toISOString()),l.append("department",e.department),l.append("year",e.year);try{const e=await r.post("/api/import-excel?action=upload",l);e&&e.success?(x(e.sessionId),g(e.errorMessages||[])):g([e?.error||"Upload failed"])}catch(t){g([n(t,"Unexpected error")])}}catch(l){g([n(l,"Unexpected error")])}finally{o(!1)}}},className:"px-6 py-3 rounded-xl font-bold "+(!i||d?"bg-gray-300 text-gray-500":"glass-button text-blue-600"),children:d?"Uploading...":"Upload"})})]}),m&&a("div",{className:"mt-6 p-4 bg-green-50 rounded-xl text-green-800",children:["Temporary session created. Session ID: ",l("span",{className:"font-mono",children:m}),l("div",{className:"mt-3",children:l("button",{onClick:async()=>{if(m){o(!0);try{try{const e=await r.post("/api/import-excel?action=confirm",{sessionId:m},{timeout:12e4});e&&e.success?h(e):g([e?.error||"Confirm failed"])}catch(e){g([n(e,"Unexpected error")])}}catch(t){g([n(t,"Unexpected error")])}finally{o(!1)}}},disabled:d,className:"px-5 py-2 rounded-lg font-semibold "+(d?"bg-gray-300 text-gray-500":"bg-green-600 text-white"),children:d?"Processing...":"Confirm Import"})})]}),p&&p.length>0&&a("div",{className:"mt-6 p-4 bg-red-50 rounded-xl text-red-800",children:[l("div",{className:"font-semibold mb-2",children:"Issues found:"}),l("ul",{className:"list-disc pl-6 space-y-1",children:p.map((e,t)=>l("li",{children:e},t))})]}),u&&a("div",{className:"mt-6 p-4 bg-blue-50 rounded-xl text-blue-900",children:[l("div",{className:"font-semibold mb-2",children:"Import Completed"}),a("div",{children:["Created: ",u.createdCount]})]}),a("div",{className:"mt-8 p-6 bg-blue-50 rounded-xl",children:[l("h4",{className:"text-lg font-semibold text-blue-900 mb-3",children:"Excel Format Requirements:"}),a("ul",{className:"text-blue-800 space-y-2",children:[a("li",{children:["• ",l("strong",{children:"Name"})," - Student full name"]}),a("li",{children:["• ",l("strong",{children:"RegNumber"})," - Student registration number"]}),a("li",{children:["• ",l("strong",{children:"Section"})," - Class section (A, B, etc.)"]}),a("li",{children:["• ",l("strong",{children:"ParentPhone"})," - Parent WhatsApp number"]}),a("li",{children:["• ",l("strong",{children:"Subject Columns"})," - Each subject with marks (0-100)"]})]})]})]})]})})}):l("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 flex items-center justify-center",children:a("div",{className:"glass-card p-8 rounded-3xl text-center",children:[l("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Access Denied"}),l("p",{className:"text-gray-600",children:"Only staff members can import marks."})]})})})}}});
